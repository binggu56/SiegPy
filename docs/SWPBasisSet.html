

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>SWPBasisSet &mdash; SiegPy 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="SWPotential" href="SWPotential.html" />
    <link rel="prev" title="1D Square-Well Potential Case" href="1DSWPCase.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> SiegPy
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api_objects.html">Code Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="1DSWPCase.html">1D Square-Well Potential Case</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">SWPBasisSet</a></li>
<li class="toctree-l3"><a class="reference internal" href="SWPotential.html">SWPotential</a></li>
<li class="toctree-l3"><a class="reference internal" href="SWPEigenstates.html">SWPEigenstates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="General1DCase.html">General 1D Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="AbstractClasses.html">Abstract classes for further analytic cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="Other.html">The Function class and its children</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SiegPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="api_objects.html">Code Documentation</a> &raquo;</li>
        
          <li><a href="1DSWPCase.html">1D Square-Well Potential Case</a> &raquo;</li>
        
      <li>SWPBasisSet</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/SWPBasisSet.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="module-siegpy.swpbasisset">
<span id="swpbasisset"></span><h1>SWPBasisSet<a class="headerlink" href="#module-siegpy.swpbasisset" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="#siegpy.swpbasisset.SWPBasisSet" title="siegpy.swpbasisset.SWPBasisSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">SWPBasisSet</span></code></a> class, representing a basis set made of
eigenstates of a 1D Square-Well Potential (SWP), is defined below.</p>
<dl class="class">
<dt id="siegpy.swpbasisset.SWPBasisSet">
<em class="property">class </em><code class="descclassname">siegpy.swpbasisset.</code><code class="descname">SWPBasisSet</code><span class="sig-paren">(</span><em>states=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/siegpy/swpbasisset.html#SWPBasisSet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#siegpy.swpbasisset.SWPBasisSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="AnalyticBasisSet.html#siegpy.analyticbasisset.AnalyticBasisSet" title="siegpy.analyticbasisset.AnalyticBasisSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">siegpy.analyticbasisset.AnalyticBasisSet</span></code></a></p>
<p>Class representing a basis set in the case of 1D Square Well
Potential. It mostly implements the abstract methods of its parent
class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>states</strong> (<em>list of SWPEigenstate instances</em>) – Eigenstates of a 1D SW potential.</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – If all states are not
<a class="reference internal" href="SWPEigenstates.html#siegpy.swpeigenstates.SWPEigenstate" title="siegpy.swpeigenstates.SWPEigenstate"><code class="xref py py-class docutils literal notranslate"><span class="pre">SWPEigenstate</span></code></a> instances.</td>
</tr>
</tbody>
</table>
<p>Example</p>
<p>A basis set is initialized by a list of states:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pot</span> <span class="o">=</span> <span class="n">SWPotential</span><span class="p">(</span><span class="mf">4.442882938158366</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bnd1</span> <span class="o">=</span> <span class="n">SWPSiegert</span><span class="p">(</span><span class="mf">4.42578048382546</span><span class="n">j</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="n">pot</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bnd2</span> <span class="o">=</span> <span class="n">SWPSiegert</span><span class="p">(</span><span class="mf">4.284084610255061</span><span class="n">j</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">pot</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bs</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="p">(</span><span class="n">states</span><span class="o">=</span><span class="p">[</span><span class="n">bnd1</span><span class="p">,</span> <span class="n">bnd2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">bs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">bnd1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">bs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">bnd2</span>
</pre></div>
</div>
<p>The basis set can be empty:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bs</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">bs</span><span class="o">.</span><span class="n">is_empty</span>
</pre></div>
</div>
<dl class="classmethod">
<dt id="siegpy.swpbasisset.SWPBasisSet.find_Siegert_states">
<em class="property">classmethod </em><code class="descname">find_Siegert_states</code><span class="sig-paren">(</span><em>pot</em>, <em>re_kmax</em>, <em>re_hk</em>, <em>im_kmax</em>, <em>im_hk=None</em>, <em>analytic=True</em>, <em>grid=None</em>, <em>bounds_only=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/siegpy/swpbasisset.html#SWPBasisSet.find_Siegert_states"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#siegpy.swpbasisset.SWPBasisSet.find_Siegert_states" title="Permalink to this definition">¶</a></dt>
<dd><p>The Siegert states wavenumbers are found using the Muller
scheme of the <a class="reference external" href="https://bit.ly/2BSVCz8">mpmath findroot method</a>. This allows one to find
a complex root of a function, starting from a wavenumber as
input guess.</p>
<p>To find the Siegert states in a given portion of the
wavenumber complex plane, a grid of input guess wavenumbers is
therefore required. The parameters specifying this grid are
listed below:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pot</strong> (<a class="reference internal" href="SWPotential.html#siegpy.swpotential.SWPotential" title="siegpy.swpotential.SWPotential"><em>SWPotential</em></a>) – 1D Square-Well Potential for which we look for the continuum
states.</li>
<li><strong>re_kmax</strong> (<em>float</em>) – Maximal value for the real part of the resonant states.</li>
<li><strong>re_hk</strong> (<em>float</em>) – Real part of the grid step for initial roots.</li>
<li><strong>im_kmax</strong> (<em>float</em>) – (Absolute) maximal value for the imaginary part of the
resonant and anti-resonant states.</li>
<li><strong>im_hk</strong> (<em>float</em>) – Imaginary part of the grid step for the initial roots
(optional, except in the cases where the imaginary part of
the resonant states becomes bigger (in absolute value) than
the imaginary part of the first bound state).</li>
<li><strong>analytic</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, scalar products with the Siegert states will be
computed analytically (default to <code class="docutils literal notranslate"><span class="pre">True</span></code>).</li>
<li><strong>grid</strong> (<em>numpy array</em><em> or </em><em>list</em><em> or </em><em>set</em>) – Discretization grid of the wavefunctions of the Siegert
states (optional).</li>
<li><strong>bounds_only</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, only the bounds states have to be found
(default to <code class="docutils literal notranslate"><span class="pre">False</span></code>).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Sorted basis set with all the Siegerts found in the
user-defined range.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#siegpy.swpbasisset.SWPBasisSet" title="siegpy.swpbasisset.SWPBasisSet">SWPBasisSet</a></p>
</td>
</tr>
</tbody>
</table>
<p>Examples</p>
<p>Read a basis set from a file as a reference:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">siegpy.swpbasisset</span> <span class="k">import</span> <span class="n">SWPBasisSet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bs_1</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;doc/notebooks/siegerts.dat&quot;</span><span class="p">,</span> <span class="n">nres</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">bs_1</span><span class="o">.</span><span class="n">resonants</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>To find the Siegert states of a given potential, proceed as
follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pot</span> <span class="o">=</span> <span class="n">bs_1</span><span class="o">.</span><span class="n">potential</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bs</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">find_Siegert_states</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">im_hk</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bs</span> <span class="o">==</span> <span class="n">bs_1</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The previous test shows that all the Siegert states of the
reference are recovered, and this includes the resonant states
whose wavenumber can have a real part up to 4.5 and an
imaginary part as low as -1.0.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">It is not ensured that all Siegert states in the defined
range are found: you may want to check the grid_step
values.</p>
</div>
<p>For instance, if the grid step along the real wavenumber axis
is too large, the reference results are not recovered:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bs</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">find_Siegert_states</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">im_hk</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bs</span> <span class="o">==</span> <span class="n">bs_1</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="siegpy.swpbasisset.SWPBasisSet.find_continuum_states">
<em class="property">classmethod </em><code class="descname">find_continuum_states</code><span class="sig-paren">(</span><em>pot</em>, <em>kmax</em>, <em>hk</em>, <em>kmin=None</em>, <em>even_only=False</em>, <em>analytic=True</em>, <em>grid=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/siegpy/swpbasisset.html#SWPBasisSet.find_continuum_states"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#siegpy.swpbasisset.SWPBasisSet.find_continuum_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a BasisSet instance made of SWPContinuum instances.
The basis set has <span class="math notranslate nohighlight">\(2*n_k\)</span> elements if <code class="docutils literal notranslate"><span class="pre">even_only=False</span></code>,
<span class="math notranslate nohighlight">\(n_k\)</span> elements otherwise (where <span class="math notranslate nohighlight">\(n_k\)</span> is the number
of continuum states defined by the grid step <code class="docutils literal notranslate"><span class="pre">hk</span></code> and the
minimal and maximal values of the wavenumber grid <code class="docutils literal notranslate"><span class="pre">kmin</span></code> and
<code class="docutils literal notranslate"><span class="pre">kmax</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pot</strong> (<a class="reference internal" href="SWPotential.html#siegpy.swpotential.SWPotential" title="siegpy.swpotential.SWPotential"><em>SWPotential</em></a>) – 1D Square-Well Potential for which we look for the continuum
states.</li>
<li><strong>kmax</strong> (<em>float</em>) – Wavenumber of the last continuum state.</li>
<li><strong>hk</strong> (<em>float</em>) – Grid step of the wavenumber grid.</li>
<li><strong>kmin</strong> (<em>float</em>) – Wavenumber of the first continuum state (optional)</li>
<li><strong>even_only</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, only even continuum states are created (default
to <code class="docutils literal notranslate"><span class="pre">False</span></code>)</li>
<li><strong>analytic</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the scalar products will be computed
analytically (default to <code class="docutils literal notranslate"><span class="pre">True</span></code>).</li>
<li><strong>grid</strong> (<em>numpy array</em><em> or </em><em>list</em><em> or </em><em>set</em>) – Discretization grid of the wavefunctions of the continuum
states (optional).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Basis set of all continuum states defined by the grid of
wavenumbers.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference internal" href="#siegpy.swpbasisset.SWPBasisSet" title="siegpy.swpbasisset.SWPBasisSet">SWPBasisSet</a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">WavenumberError</span></code> – If <code class="docutils literal notranslate"><span class="pre">hk</span></code>, <code class="docutils literal notranslate"><span class="pre">kmin</span></code> or <code class="docutils literal notranslate"><span class="pre">`kmax</span></code> is not strictly positive.</p>
</td>
</tr>
</tbody>
</table>
<p>Examples</p>
<p>Let us start by defining a potential:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">siegpy.swpbasisset</span> <span class="k">import</span> <span class="n">SWPBasisSet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bs_ref</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;doc/notebooks/siegerts.dat&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pot</span> <span class="o">=</span> <span class="n">bs_ref</span><span class="o">.</span><span class="n">potential</span>
</pre></div>
</div>
<p>The continuum states are found, given a potential and a grid
of initial wavenumbers (note that the minimal and maximal
wavenumber cannot be 0)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hk</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">kmax</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bs</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">find_continuum_states</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">hk</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bs</span><span class="o">.</span><span class="n">wavenumbers</span>
<span class="go">[1.0, 1.0, 2.0, 2.0, 3.0, 3.0]</span>
</pre></div>
</div>
<p>It is possible to find only the even continuum states:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">pot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bs</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">find_continuum_states</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">hk</span><span class="p">,</span> <span class="n">even_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bs</span><span class="o">.</span><span class="n">wavenumbers</span>
<span class="go">[1.0, 2.0, 3.0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">bs</span><span class="o">.</span><span class="n">even</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">bs</span><span class="o">.</span><span class="n">odd</span><span class="o">.</span><span class="n">is_empty</span>
</pre></div>
</div>
<p>The minimal wavenumber can set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bs</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">find_continuum_states</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">hk</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bs</span><span class="o">.</span><span class="n">wavenumbers</span>
<span class="go">[3.0, 3.0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="siegpy.swpbasisset.SWPBasisSet.parity">
<code class="descname">parity</code><a class="headerlink" href="#siegpy.swpbasisset.SWPBasisSet.parity" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">None</span></code> if both parities are present, <code class="docutils literal notranslate"><span class="pre">'e'</span></code> or <code class="docutils literal notranslate"><span class="pre">'o'</span></code> if
all the states are even or odd, respectively.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">None or str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="siegpy.swpbasisset.SWPBasisSet.even">
<code class="descname">even</code><a class="headerlink" href="#siegpy.swpbasisset.SWPBasisSet.even" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">All the even states of the basis set.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#siegpy.swpbasisset.SWPBasisSet" title="siegpy.swpbasisset.SWPBasisSet">SWPBasisSet</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="siegpy.swpbasisset.SWPBasisSet.odd">
<code class="descname">odd</code><a class="headerlink" href="#siegpy.swpbasisset.SWPBasisSet.odd" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">All the odd states of the basis set.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#siegpy.swpbasisset.SWPBasisSet" title="siegpy.swpbasisset.SWPBasisSet">SWPBasisSet</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="siegpy.swpbasisset.SWPBasisSet.plot_wavefunctions">
<code class="descname">plot_wavefunctions</code><span class="sig-paren">(</span><em>nres=None</em>, <em>xlim=None</em>, <em>ylim=None</em>, <em>title=None</em>, <em>file_save=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/siegpy/swpbasisset.html#SWPBasisSet.plot_wavefunctions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#siegpy.swpbasisset.SWPBasisSet.plot_wavefunctions" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the bound, resonant and anti-resonant wavefunctions of the
basis set along with the potential. The continuum and anti-bound
states, if any are present in the basis set, are not plotted.</p>
<p>The wavefunctions are translated along the y-axis by their
energy (for bound states) or absolute value of their energy (for
resonant and anti-resonant states).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nres</strong> (<em>int</em>) – Number of resonant and antiresonant wavefunctions to plot.</li>
<li><strong>xlim</strong> (<em>tuple</em><em>(</em><em>float</em><em> or </em><em>int</em><em>, </em><em>float</em><em> or </em><em>int</em><em>)</em>) – Range of the x axis of the plot (optional)</li>
<li><strong>ylim</strong> (<em>tuple</em><em>(</em><em>float</em><em> or </em><em>int</em><em>, </em><em>float</em><em> or </em><em>int</em><em>)</em>) – Range of the y axis of the plot (optional)</li>
<li><strong>title</strong> (<em>str</em>) – Plot title (optional).</li>
<li><strong>file_save</strong> (<em>str</em>) – Filename of the plot to be saved (optional)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="siegpy.swpbasisset.SWPBasisSet.continuum_contributions_to_CR">
<code class="descname">continuum_contributions_to_CR</code><span class="sig-paren">(</span><em>test</em>, <em>hk=None</em>, <em>kmax=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/siegpy/swpbasisset.html#SWPBasisSet.continuum_contributions_to_CR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#siegpy.swpbasisset.SWPBasisSet.continuum_contributions_to_CR" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the continuum contributions to the completeness
relation.</p>
<p>This is an overriding of the inherited
<a class="reference internal" href="AnalyticBasisSet.html#siegpy.analyticbasisset.AnalyticBasisSet.continuum_contributions_to_CR" title="siegpy.analyticbasisset.AnalyticBasisSet.continuum_contributions_to_CR"><code class="xref py py-meth docutils literal notranslate"><span class="pre">siegpy.analyticbasisset.AnalyticBasisSet.continuum_contributions_to_CR()</span></code></a>
method in order to account for the parity of the continuum
states of the Square-Well potential.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>test</strong> (<a class="reference internal" href="Functions.html#siegpy.functions.Function" title="siegpy.functions.Function"><em>Function</em></a>) – Test function.</li>
<li><strong>hk</strong> (<em>float</em>) – Grid step for the wavenumbers of the “on-the-fly” continuum
basis sets (optional).</li>
<li><strong>kmax</strong> (<em>float</em>) – Maximal wavenumber of the on-the-fly continuum basis set
(optional).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Contribution of each continuum state of the basis set to the
exact completeness relation.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">numpy array</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">BasisSetError</span></code> – If the basis set has less odd continuum states than even
continuum states when the test function is not even.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="siegpy.swpbasisset.SWPBasisSet._evaluate_integrand">
<em class="property">static </em><code class="descname">_evaluate_integrand</code><span class="sig-paren">(</span><em>q</em>, <em>k</em>, <em>test</em>, <em>eta</em>, <em>potential</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/siegpy/swpbasisset.html#SWPBasisSet._evaluate_integrand"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#siegpy.swpbasisset.SWPBasisSet._evaluate_integrand" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the integrand used to compute the strength function
“on-the-fly.”</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>q</strong> (<em>float</em>) – Wavenumber of the continuum state considered.</li>
<li><strong>k</strong> (<em>float</em>) – Wavenumber for which the strength function is evaluated.</li>
<li><strong>test</strong> (<a class="reference internal" href="Functions.html#siegpy.functions.Function" title="siegpy.functions.Function"><em>Function</em></a>) – Test function.</li>
<li><strong>eta</strong> (<em>float</em>) – Infinitesimal for integration (if <code class="docutils literal notranslate"><span class="pre">None</span></code>, default to 10
times the value of the grid-step of the continuum basis
set).</li>
<li><strong>potential</strong> (<a class="reference internal" href="Potential.html#siegpy.potential.Potential" title="siegpy.potential.Potential"><em>Potential</em></a>) – Potential of the currently studied analytical case.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the integrand.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">complex</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="siegpy.swpbasisset.SWPBasisSet._propagate">
<code class="descname">_propagate</code><span class="sig-paren">(</span><em>test</em>, <em>time_grid</em>, <em>weights=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/siegpy/swpbasisset.html#SWPBasisSet._propagate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#siegpy.swpbasisset.SWPBasisSet._propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the time-propagation of a test wavepacket as the matrix
product of two matrices: one to account for the time dependance
of the propagation of the wavepacket (mat_time), the other for
its space dependance (mat_space).</p>
<p>This is an overriding of the inherited
<a class="reference internal" href="BasisSet.html#siegpy.basisset.BasisSet._propagate" title="siegpy.basisset.BasisSet._propagate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">siegpy.basisset.BasisSet._propagate()</span></code></a> method to take into
account the parity of the eigenstates in the 1D SWP case.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>test</strong> (<a class="reference internal" href="Functions.html#siegpy.functions.Function" title="siegpy.functions.Function"><em>Function</em></a>) – Test function.</li>
<li><strong>time_grid</strong> (<em>numpy array</em><em> or </em><em>list of positive numbers</em>) – Times for which the propagation is evaluated. It must
contain positive numbers only.</li>
<li><strong>weights</strong> (<em>dict</em>) – Dictionary of the weights to use for the time-propagation.
Keys correspond to a type of Siegert states (‘ab’ for
anti-bounds, ‘b’ for bounds, ‘r’ for resonants and ‘ar’ for
anti-resonants) and the corresponding value is the weight to
use for all the states of the given type (optional).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Propagated wavepacket for the different times of
<code class="docutils literal notranslate"><span class="pre">time_grid</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">2D numpy array</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">BasisSetError</span></code> – If the basis set has less odd continuum states than even
continuum states when the test function is not even.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="siegpy.swpbasisset.SWPBasisSet._add_one_continuum_state">
<code class="descname">_add_one_continuum_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/siegpy/swpbasisset.html#SWPBasisSet._add_one_continuum_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#siegpy.swpbasisset.SWPBasisSet._add_one_continuum_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Add two continuum state to the basis set, depending on the
already existing continuum states.</p>
<p>This is an overriding of the inherited
<a class="reference internal" href="AnalyticBasisSet.html#siegpy.analyticbasisset.AnalyticBasisSet._add_one_continuum_state" title="siegpy.analyticbasisset.AnalyticBasisSet._add_one_continuum_state"><code class="xref py py-meth docutils literal notranslate"><span class="pre">siegpy.analyticbasisset.AnalyticBasisSet._add_one_continuum_state()</span></code></a>
method to account for the parity of the continuum states in the
1D SWP case.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The same basis set with one more continuum state.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#siegpy.swpbasisset.SWPBasisSet" title="siegpy.swpbasisset.SWPBasisSet">SWPBasisSet</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="SWPotential.html" class="btn btn-neutral float-right" title="SWPotential" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="1DSWPCase.html" class="btn btn-neutral" title="1D Square-Well Potential Case" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Maxime Morinière.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>