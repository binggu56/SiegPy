

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Influence of the coordinate mapping parameters: case study of the ErfKGCoordMap &mdash; SiegPy 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Influence of the grid for continuum states" href="influence_grid_continuum.html" />
    <link rel="prev" title="Influence of the filters" href="influence_filters_siegerts.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> SiegPy
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../notebooks.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#d-square-well-potential-the-analytical-case">1D Square-Well Potential: the analytical case</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../notebooks.html#d-square-well-potential-the-numerical-case">1D Square-Well Potential: the numerical case</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="find_numerical_bound_and_continuum.html">Numerical potential: bound and continuum states</a></li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation_numerical_bound_and_continuum.html">Completeness relation using numerical bound and continuum states</a></li>
<li class="toctree-l3"><a class="reference internal" href="find_numerical_Siegert.html">Numerical potential: Siegert states</a></li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation_numerical_Siegert.html">Completeness relation with numerical Siegert states</a></li>
<li class="toctree-l3"><a class="reference internal" href="influence_virials_siegerts.html">Virial operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="influence_filters_siegerts.html">Influence of the filters</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Influence of the coordinate mapping parameters: case study of the ErfKGCoordMap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Initialization">Initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Influence-of-">Influence of <span class="math notranslate nohighlight">\(\theta\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Influence-of-">Influence of <span class="math notranslate nohighlight">\(x_0\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Influence-of-">Influence of <span class="math notranslate nohighlight">\(\lambda\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Conclusions:">Conclusions:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="influence_grid_continuum.html">Influence of the grid for continuum states</a></li>
<li class="toctree-l3"><a class="reference internal" href="influence_grid_siegerts.html">Influence of the grid for Siegert states</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#other-numerical-potentials">Other numerical potentials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_objects.html">Code Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SiegPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../notebooks.html">Tutorial</a> &raquo;</li>
        
      <li>Influence of the coordinate mapping parameters: case study of the ErfKGCoordMap</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/influence_coordMap_siegerts_1.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Influence-of-the-coordinate-mapping-parameters:-case-study-of-the-ErfKGCoordMap">
<h1>Influence of the coordinate mapping parameters: case study of the ErfKGCoordMap<a class="headerlink" href="#Influence-of-the-coordinate-mapping-parameters:-case-study-of-the-ErfKGCoordMap" title="Permalink to this headline">¶</a></h1>
<p>Another important set of parameters when solving Hamiltonians
numerically with SiegPy is the choice of the coordinate mapping. There
are many coordinate mappings available in the SiegPy module, but let us
focus first on one type of smooth, exterior coordinate mapping, namely
the <code class="docutils literal notranslate"><span class="pre">ErfKGCoordMap</span></code>.</p>
<p>This type of coordinate mapping depends on three parameters:</p>
<ul class="simple">
<li>the complex scaling angle <span class="math notranslate nohighlight">\(\theta\)</span>,</li>
<li>the inflexion point <span class="math notranslate nohighlight">\(x_0\)</span>,</li>
<li>the sharpness parameter <span class="math notranslate nohighlight">\(\lambda\)</span>.</li>
</ul>
<p>The goal of the present notebook is to witness the influence of these
parameters on the numerical spectrum obtained after the Hamiltonian
diagonalization.</p>
<div class="section" id="Initialization">
<h2>Initialization<a class="headerlink" href="#Initialization" title="Permalink to this headline">¶</a></h2>
<p>The initialization consists in importing the relevant modules and
classes and defining a potential that will be used throuhout the
notebook.</p>
<div class="section" id="Import-some-modules-and-classes">
<h3>Import some modules and classes<a class="headerlink" href="#Import-some-modules-and-classes" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">siegpy</span> <span class="k">import</span> <span class="p">(</span><span class="n">Hamiltonian</span><span class="p">,</span> <span class="n">SWPotential</span><span class="p">,</span> <span class="n">SWPBasisSet</span><span class="p">,</span>
                    <span class="n">ErfKGCoordMap</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Define-a-potential">
<h3>Define a potential<a class="headerlink" href="#Define-a-potential" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># The potential is read from a file...</span>
<span class="n">siegerts</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;siegerts.dat&quot;</span><span class="p">)</span>
<span class="n">pot</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">potential</span>
<span class="c1"># ... and then discretized over a grid</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">pot</span><span class="o">.</span><span class="n">width</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mf">7.5</span>
<span class="n">xgrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">xmax</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="mi">501</span><span class="p">)</span>
<span class="n">pot</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="n">xgrid</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Influence-of-">
<h2>Influence of <span class="math notranslate nohighlight">\(\theta\)</span><a class="headerlink" href="#Influence-of-" title="Permalink to this headline">¶</a></h2>
<p>Let us first look at the influence of the <span class="math notranslate nohighlight">\(\theta\)</span> parameter by
varying it, while the other parameters are constant.</p>
<div class="section" id="Define-the-coordinate-mappings">
<h3>Define the coordinate mappings<a class="headerlink" href="#Define-the-coordinate-mappings" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">thetas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">6.0</span>
<span class="n">lbda</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">cms_tta</span> <span class="o">=</span> <span class="p">[</span><span class="n">ErfKGCoordMap</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">lbda</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">xgrid</span><span class="p">)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>All the coordinate mappings are plotted below:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cm</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cms_tta</span><span class="p">):</span>
    <span class="n">lab</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">lab</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Re[$F$]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Im[$F$]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Varying $\theta$&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_10_0.png" src="../_images/notebooks_influence_coordMap_siegerts_1_10_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="p">[{</span><span class="s2">&quot;str&quot;</span><span class="p">:</span> <span class="s2">&quot;Re&quot;</span><span class="p">,</span> <span class="s2">&quot;func&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">},</span>
             <span class="p">{</span><span class="s2">&quot;str&quot;</span><span class="p">:</span> <span class="s2">&quot;Im&quot;</span><span class="p">,</span> <span class="s2">&quot;func&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">}]:</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cm</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cms_tta</span><span class="p">):</span>
        <span class="n">lab</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span> <span class="n">part</span><span class="p">[</span><span class="s2">&quot;func&quot;</span><span class="p">](</span><span class="n">cm</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">lab</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">part</span><span class="p">[</span><span class="s2">&quot;str&quot;</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;[$F$]&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Varying $\theta$&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_11_0.png" src="../_images/notebooks_influence_coordMap_siegerts_1_11_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_11_1.png" src="../_images/notebooks_influence_coordMap_siegerts_1_11_1.png" />
</div>
</div>
</div>
<div class="section" id="Define-the-Hamiltonians">
<h3>Define the Hamiltonians<a class="headerlink" href="#Define-the-Hamiltonians" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hams_tta</span> <span class="o">=</span> <span class="p">[</span><span class="n">Hamiltonian</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">cm</span><span class="p">)</span> <span class="k">for</span> <span class="n">cm</span> <span class="ow">in</span> <span class="n">cms_tta</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Solve-the-Hamiltonians">
<h3>Solve the Hamiltonians<a class="headerlink" href="#Solve-the-Hamiltonians" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">basissets_tta</span> <span class="o">=</span> <span class="p">[</span><span class="n">ham</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span> <span class="k">for</span> <span class="n">ham</span> <span class="ow">in</span> <span class="n">hams_tta</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Compare-the-results">
<h3>Compare the results<a class="headerlink" href="#Compare-the-results" title="Permalink to this headline">¶</a></h3>
<p>Let us first have a look at the global picture, by plotting the energies
and virial expectation values of all the eigenstates:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">basis</span> <span class="ow">in</span> <span class="n">basissets_tta</span><span class="p">:</span>
    <span class="n">tit</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\theta$ = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">coord_map</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">basis</span><span class="o">.</span><span class="n">plot_energies</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">tit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_17_0.png" src="../_images/notebooks_influence_coordMap_siegerts_1_17_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_17_1.png" src="../_images/notebooks_influence_coordMap_siegerts_1_17_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_17_2.png" src="../_images/notebooks_influence_coordMap_siegerts_1_17_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_17_3.png" src="../_images/notebooks_influence_coordMap_siegerts_1_17_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_17_4.png" src="../_images/notebooks_influence_coordMap_siegerts_1_17_4.png" />
</div>
</div>
<p>While the overall distibution of energies in the complex energy plane is
modified by the complex scaling angle <span class="math notranslate nohighlight">\(\theta\)</span>, the virial
expectation values seem to be consistent over the whole range of angles.
In particular, the resonant states do not seem to be largely affected by
the angle modification. Let us zoom in for a clearer view:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">basis</span> <span class="ow">in</span> <span class="n">basissets_tta</span><span class="p">:</span>
    <span class="n">tit</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\theta$ = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">coord_map</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">basis</span><span class="o">.</span><span class="n">plot_energies</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">4000</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="n">tit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_19_0.png" src="../_images/notebooks_influence_coordMap_siegerts_1_19_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_19_1.png" src="../_images/notebooks_influence_coordMap_siegerts_1_19_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_19_2.png" src="../_images/notebooks_influence_coordMap_siegerts_1_19_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_19_3.png" src="../_images/notebooks_influence_coordMap_siegerts_1_19_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_19_4.png" src="../_images/notebooks_influence_coordMap_siegerts_1_19_4.png" />
</div>
</div>
<p>The highest energy resonant states seem to be unaffected by the complex
scaling angle. Let us zoom in again, to look at what happens close to
the 0 energy:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">basis</span> <span class="ow">in</span> <span class="n">basissets_tta</span><span class="p">:</span>
    <span class="n">tit</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\theta$ = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">coord_map</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">basis</span><span class="o">.</span><span class="n">plot_energies</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">7.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="n">tit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_21_0.png" src="../_images/notebooks_influence_coordMap_siegerts_1_21_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_21_1.png" src="../_images/notebooks_influence_coordMap_siegerts_1_21_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_21_2.png" src="../_images/notebooks_influence_coordMap_siegerts_1_21_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_21_3.png" src="../_images/notebooks_influence_coordMap_siegerts_1_21_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_21_4.png" src="../_images/notebooks_influence_coordMap_siegerts_1_21_4.png" />
</div>
</div>
<p>There are many things to be said here:</p>
<ul class="simple">
<li>Focusing on the <span class="math notranslate nohighlight">\(\theta = 0.2\)</span> case, one sees that, if the
highest energy resonant states are found with a low virial
expectation value, the closest one to the 0 energy are somehow hidden
between the other solutions. This is due to the fact that the complex
scaling angle is too small for these resonant states to be “unveiled”
by the coordinate mapping. There is actually a critical angle
<span class="math notranslate nohighlight">\(\theta_c\)</span> associated to each resonant state, given by
<span class="math notranslate nohighlight">\(\theta_c = \frac{\text{arctan}(E_I/E_R)}{2}\)</span>, where
<span class="math notranslate nohighlight">\(E_R\)</span> (respectively <span class="math notranslate nohighlight">\(E_I\)</span> is the real (resp. imaginary)
part of the resonant state energy. If the complex scaling angle is
higher than this number, then the resonant state appear as a single
eigenstate:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">en</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">resonants</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">energy</span>  <span class="c1"># Energy of the resonant state</span>
    <span class="n">theta_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">en</span><span class="o">.</span><span class="n">imag</span> <span class="o">/</span> <span class="n">en</span><span class="o">.</span><span class="n">real</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># critical angle</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resonant state n°</span><span class="si">{}</span><span class="s2">: theta_c = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">theta_c</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Resonant state n°0: theta_c = 0.22854546301537398
Resonant state n°1: theta_c = 0.1516923699784277
Resonant state n°2: theta_c = 0.12463899292846521
</pre></div></div>
</div>
<p>This explains why the first resonant state does not appear as a single
state if <span class="math notranslate nohighlight">\(\theta = 0.2\)</span>, while all the others appear as single
states (because the imaginary part of the resonants states increases
more slowly than the real part). For all the higher complex scaling
angles, this first resonant state appears as a single eigenstate of the
complex scaled Hamiltonian.</p>
<p>Another interesting point is to see that the energies of the “continuum”
states close to the 0 energy are rotated proportionnally to the complex
scaling angle.</p>
<p>Finally, when the complex scaling angle becomes too high, the bound
states (that are not greatly modified by the complex scaling angle
otherwise) start exhibiting lower virial expectation values, especially
those with the highest energy.</p>
<p>The complex scaling angle therefore has to be chosen so that it is high
enough to unveil all the important resonant states while leaving
allowing for a good discrimination of the Siegert states.</p>
</div>
</div>
<div class="section" id="Influence-of-">
<h2>Influence of <span class="math notranslate nohighlight">\(x_0\)</span><a class="headerlink" href="#Influence-of-" title="Permalink to this headline">¶</a></h2>
<p>Let us now study the influence of the inlfexion point on the spectrum of
the complex scaled Hamiltonians. The same pattern is kept: only
<span class="math notranslate nohighlight">\(x_0\)</span> is varied, while the other parameters are constant:</p>
<div class="section" id="Define-the-coordinate-mappings">
<h3>Define the coordinate mappings<a class="headerlink" href="#Define-the-coordinate-mappings" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">theta</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">x0s</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">]</span>  <span class="c1"># Only x0 varies</span>
<span class="n">lbda</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">cms_x0</span> <span class="o">=</span> <span class="p">[</span><span class="n">ErfKGCoordMap</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">lbda</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">xgrid</span><span class="p">)</span> <span class="k">for</span> <span class="n">x0</span> <span class="ow">in</span> <span class="n">x0s</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cm</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cms_x0</span><span class="p">):</span>
    <span class="n">lab</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">x0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">lab</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Re[$F$]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Im[$F$]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Varying $x_0$&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_28_0.png" src="../_images/notebooks_influence_coordMap_siegerts_1_28_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="p">[{</span><span class="s2">&quot;str&quot;</span><span class="p">:</span> <span class="s2">&quot;Re&quot;</span><span class="p">,</span> <span class="s2">&quot;func&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">},</span>
             <span class="p">{</span><span class="s2">&quot;str&quot;</span><span class="p">:</span> <span class="s2">&quot;Im&quot;</span><span class="p">,</span> <span class="s2">&quot;func&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">}]:</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cm</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cms_x0</span><span class="p">):</span>
        <span class="n">lab</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">x0</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span> <span class="n">part</span><span class="p">[</span><span class="s2">&quot;func&quot;</span><span class="p">](</span><span class="n">cm</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">lab</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">part</span><span class="p">[</span><span class="s2">&quot;str&quot;</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;[$F$]&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Varying $x_0$&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_29_0.png" src="../_images/notebooks_influence_coordMap_siegerts_1_29_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_29_1.png" src="../_images/notebooks_influence_coordMap_siegerts_1_29_1.png" />
</div>
</div>
</div>
<div class="section" id="Define-the-Hamiltonians">
<h3>Define the Hamiltonians<a class="headerlink" href="#Define-the-Hamiltonians" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hams_x0</span> <span class="o">=</span> <span class="p">[</span><span class="n">Hamiltonian</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">cm</span><span class="p">)</span> <span class="k">for</span> <span class="n">cm</span> <span class="ow">in</span> <span class="n">cms_x0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Solve-the-Hamiltonians">
<h3>Solve the Hamiltonians<a class="headerlink" href="#Solve-the-Hamiltonians" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">basissets_x0</span> <span class="o">=</span> <span class="p">[</span><span class="n">ham</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span> <span class="k">for</span> <span class="n">ham</span> <span class="ow">in</span> <span class="n">hams_x0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Compare-the-results">
<h3>Compare the results<a class="headerlink" href="#Compare-the-results" title="Permalink to this headline">¶</a></h3>
<p>Let us first have a look at the global picture, by plotting the energies
and virial expectation values of all the eigenstates:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">basis</span> <span class="ow">in</span> <span class="n">basissets_x0</span><span class="p">:</span>
    <span class="n">tit</span> <span class="o">=</span> <span class="s2">&quot;$x_0$ = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">coord_map</span><span class="o">.</span><span class="n">x0</span><span class="p">)</span>
    <span class="n">basis</span><span class="o">.</span><span class="n">plot_energies</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">tit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_35_0.png" src="../_images/notebooks_influence_coordMap_siegerts_1_35_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_35_1.png" src="../_images/notebooks_influence_coordMap_siegerts_1_35_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_35_2.png" src="../_images/notebooks_influence_coordMap_siegerts_1_35_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_35_3.png" src="../_images/notebooks_influence_coordMap_siegerts_1_35_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_35_4.png" src="../_images/notebooks_influence_coordMap_siegerts_1_35_4.png" />
</div>
</div>
<p>Again, the distribution of the eigenstates varies greatly with
<span class="math notranslate nohighlight">\(x_0\)</span>, but not the real energy range, nor the range of the
expectation values of the virial operator.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">basis</span> <span class="ow">in</span> <span class="n">basissets_x0</span><span class="p">:</span>
    <span class="n">tit</span> <span class="o">=</span> <span class="s2">&quot;$x_0$ = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">coord_map</span><span class="o">.</span><span class="n">x0</span><span class="p">)</span>
    <span class="n">basis</span><span class="o">.</span><span class="n">plot_energies</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">4000</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="n">tit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_37_0.png" src="../_images/notebooks_influence_coordMap_siegerts_1_37_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_37_1.png" src="../_images/notebooks_influence_coordMap_siegerts_1_37_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_37_2.png" src="../_images/notebooks_influence_coordMap_siegerts_1_37_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_37_3.png" src="../_images/notebooks_influence_coordMap_siegerts_1_37_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_37_4.png" src="../_images/notebooks_influence_coordMap_siegerts_1_37_4.png" />
</div>
</div>
<p>Zooming in a little closer shows little modification of the Siegert
states spectrum, and this is further evidenced by zooming in even more
closely:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">basis</span> <span class="ow">in</span> <span class="n">basissets_x0</span><span class="p">:</span>
    <span class="n">tit</span> <span class="o">=</span> <span class="s2">&quot;$x_0$ = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">coord_map</span><span class="o">.</span><span class="n">x0</span><span class="p">)</span>
    <span class="n">basis</span><span class="o">.</span><span class="n">plot_energies</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">7.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="n">tit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_39_0.png" src="../_images/notebooks_influence_coordMap_siegerts_1_39_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_39_1.png" src="../_images/notebooks_influence_coordMap_siegerts_1_39_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_39_2.png" src="../_images/notebooks_influence_coordMap_siegerts_1_39_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_39_3.png" src="../_images/notebooks_influence_coordMap_siegerts_1_39_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_39_4.png" src="../_images/notebooks_influence_coordMap_siegerts_1_39_4.png" />
</div>
</div>
<p>It nevertheless seems important to leave a sufficiently large “buffer”
region at the end of the discretization grid in order to let the
coordinate mapping be fully efficient (a degradatation of the energies
and virial values can be observed for <span class="math notranslate nohighlight">\(x_0 = 7.0\)</span>)</p>
<p>The difference is actually mostly seen on the wavefunctions, especially
those of the resonant states:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">basis</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">basissets_x0</span><span class="p">):</span>
    <span class="n">basis</span><span class="o">.</span><span class="n">max_virial</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">tit</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$x_0 = </span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x0s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">basis</span><span class="o">.</span><span class="n">plot_wavefunctions</span><span class="p">(</span><span class="n">nres</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">tit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_41_0.png" src="../_images/notebooks_influence_coordMap_siegerts_1_41_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_41_1.png" src="../_images/notebooks_influence_coordMap_siegerts_1_41_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_41_2.png" src="../_images/notebooks_influence_coordMap_siegerts_1_41_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_41_3.png" src="../_images/notebooks_influence_coordMap_siegerts_1_41_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_41_4.png" src="../_images/notebooks_influence_coordMap_siegerts_1_41_4.png" />
</div>
</div>
<p>The larger the value of <span class="math notranslate nohighlight">\(x_0\)</span>, the larger the extension of the
resonant state wavefunction. This is exactly the role of this parameter,
so there is no surprise here.</p>
<p>However, it may have an influence on the bound states wavefunctions,
especially for those of highest energy, which have longer exponential
tails:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">basis</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">basissets_x0</span><span class="p">):</span>
    <span class="n">basis</span><span class="o">.</span><span class="n">max_virial</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">last_bound</span> <span class="o">=</span> <span class="n">basis</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">tit</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$x_0 = </span><span class="si">{}</span><span class="s2">$; E = </span><span class="si">{:.4f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x0s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">last_bound</span><span class="o">.</span><span class="n">energy</span><span class="p">)</span>
    <span class="n">last_bound</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">tit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_43_0.png" src="../_images/notebooks_influence_coordMap_siegerts_1_43_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_43_1.png" src="../_images/notebooks_influence_coordMap_siegerts_1_43_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_43_2.png" src="../_images/notebooks_influence_coordMap_siegerts_1_43_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_43_3.png" src="../_images/notebooks_influence_coordMap_siegerts_1_43_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_43_4.png" src="../_images/notebooks_influence_coordMap_siegerts_1_43_4.png" />
</div>
</div>
<p>This is not a problem since it does not greatly affect the energy and
the wavefunctions inside the potential.</p>
</div>
</div>
<div class="section" id="Influence-of-">
<h2>Influence of <span class="math notranslate nohighlight">\(\lambda\)</span><a class="headerlink" href="#Influence-of-" title="Permalink to this headline">¶</a></h2>
<p>Let us finally have a look at the last parameter: the sharpness
parameter.</p>
<div class="section" id="Define-the-coordinate-mappings">
<h3>Define the coordinate mappings<a class="headerlink" href="#Define-the-coordinate-mappings" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">theta</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">6.0</span>
<span class="n">lbdas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]</span>
<span class="n">cms_lbda</span> <span class="o">=</span> <span class="p">[</span><span class="n">ErfKGCoordMap</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">lbda</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">xgrid</span><span class="p">)</span> <span class="k">for</span> <span class="n">lbda</span> <span class="ow">in</span> <span class="n">lbdas</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>For the smallest sharpness value, the coordinate mapping almost
corresponds to the uniform coordinate mapping
<span class="math notranslate nohighlight">\(F: x \mapsto x e^{i \theta}\)</span>, while the largest values exhibit
sharp transitions:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cm</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cms_lbda</span><span class="p">):</span>
    <span class="n">lab</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">lbda</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">lab</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Re[$F$]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Im[$F$]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Varying $\lambda$&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_49_0.png" src="../_images/notebooks_influence_coordMap_siegerts_1_49_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="p">[{</span><span class="s2">&quot;str&quot;</span><span class="p">:</span> <span class="s2">&quot;Re&quot;</span><span class="p">,</span> <span class="s2">&quot;func&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">},</span>
             <span class="p">{</span><span class="s2">&quot;str&quot;</span><span class="p">:</span> <span class="s2">&quot;Im&quot;</span><span class="p">,</span> <span class="s2">&quot;func&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">}]:</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cm</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cms_lbda</span><span class="p">):</span>
        <span class="n">lab</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">lbda</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span> <span class="n">part</span><span class="p">[</span><span class="s2">&quot;func&quot;</span><span class="p">](</span><span class="n">cm</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">lab</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">part</span><span class="p">[</span><span class="s2">&quot;str&quot;</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;[$F$]&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Varying $\lambda$&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_50_0.png" src="../_images/notebooks_influence_coordMap_siegerts_1_50_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_50_1.png" src="../_images/notebooks_influence_coordMap_siegerts_1_50_1.png" />
</div>
</div>
</div>
<div class="section" id="Define-the-Hamiltonians">
<h3>Define the Hamiltonians<a class="headerlink" href="#Define-the-Hamiltonians" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hams_lbda</span> <span class="o">=</span> <span class="p">[</span><span class="n">Hamiltonian</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">cm</span><span class="p">)</span> <span class="k">for</span> <span class="n">cm</span> <span class="ow">in</span> <span class="n">cms_lbda</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Solve-the-Hamiltonians">
<h3>Solve the Hamiltonians<a class="headerlink" href="#Solve-the-Hamiltonians" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">basissets_lbda</span> <span class="o">=</span> <span class="p">[</span><span class="n">ham</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span> <span class="k">for</span> <span class="n">ham</span> <span class="ow">in</span> <span class="n">hams_lbda</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Compare-the-results">
<h3>Compare the results<a class="headerlink" href="#Compare-the-results" title="Permalink to this headline">¶</a></h3>
<p>Let us first have a look at the global picture, by plotting the energies
and virial expectation values of all the eigenstates:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">basis</span> <span class="ow">in</span> <span class="n">basissets_lbda</span><span class="p">:</span>
    <span class="n">tit</span> <span class="o">=</span> <span class="s2">&quot;$\lambda$ = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">coord_map</span><span class="o">.</span><span class="n">lbda</span><span class="p">)</span>
    <span class="n">basis</span><span class="o">.</span><span class="n">plot_energies</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">tit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_56_0.png" src="../_images/notebooks_influence_coordMap_siegerts_1_56_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_56_1.png" src="../_images/notebooks_influence_coordMap_siegerts_1_56_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_56_2.png" src="../_images/notebooks_influence_coordMap_siegerts_1_56_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_56_3.png" src="../_images/notebooks_influence_coordMap_siegerts_1_56_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_56_4.png" src="../_images/notebooks_influence_coordMap_siegerts_1_56_4.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_56_5.png" src="../_images/notebooks_influence_coordMap_siegerts_1_56_5.png" />
</div>
</div>
<p>There are two limiting cases: either the sharpness parameter is too
large or it is too small, leading to wrong or degraded results, where
the bound and/or the resonant states are not well reproduced.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">basis</span> <span class="ow">in</span> <span class="n">basissets_lbda</span><span class="p">:</span>
    <span class="n">tit</span> <span class="o">=</span> <span class="s2">&quot;$\lambda$ = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">coord_map</span><span class="o">.</span><span class="n">lbda</span><span class="p">)</span>
    <span class="n">basis</span><span class="o">.</span><span class="n">plot_energies</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">4000</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="n">tit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_58_0.png" src="../_images/notebooks_influence_coordMap_siegerts_1_58_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_58_1.png" src="../_images/notebooks_influence_coordMap_siegerts_1_58_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_58_2.png" src="../_images/notebooks_influence_coordMap_siegerts_1_58_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_58_3.png" src="../_images/notebooks_influence_coordMap_siegerts_1_58_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_58_4.png" src="../_images/notebooks_influence_coordMap_siegerts_1_58_4.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_58_5.png" src="../_images/notebooks_influence_coordMap_siegerts_1_58_5.png" />
</div>
</div>
<p>By zooming more closely, it appears that if lambda is too small, then
the energies can be completelt wrong, while the range of the virial
values is consistent with the other calcultions, while, if it gets too
large, the range of resonant states get so small that no resonant states
can be discriminated from the rest of the states, even though
<span class="math notranslate nohighlight">\(\theta\)</span> is large enough for the resonant states to be
singled-out:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">basis</span> <span class="ow">in</span> <span class="n">basissets_lbda</span><span class="p">:</span>
    <span class="n">tit</span> <span class="o">=</span> <span class="s2">&quot;$\lambda$ = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">coord_map</span><span class="o">.</span><span class="n">lbda</span><span class="p">)</span>
    <span class="n">basis</span><span class="o">.</span><span class="n">plot_energies</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">7.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="n">tit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_60_0.png" src="../_images/notebooks_influence_coordMap_siegerts_1_60_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_60_1.png" src="../_images/notebooks_influence_coordMap_siegerts_1_60_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_60_2.png" src="../_images/notebooks_influence_coordMap_siegerts_1_60_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_60_3.png" src="../_images/notebooks_influence_coordMap_siegerts_1_60_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_60_4.png" src="../_images/notebooks_influence_coordMap_siegerts_1_60_4.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_coordMap_siegerts_1_60_5.png" src="../_images/notebooks_influence_coordMap_siegerts_1_60_5.png" />
</div>
</div>
<p>The last plot two plots show that a degradation of the virial values or
even of the energies can happen if the transition is too sharp.</p>
</div>
</div>
<div class="section" id="Conclusions:">
<h2>Conclusions:<a class="headerlink" href="#Conclusions:" title="Permalink to this headline">¶</a></h2>
<p>We saw the influence of each parameter on the smooth exterior complex
scaling. Let us summarize the main results:</p>
<ul class="simple">
<li>For <span class="math notranslate nohighlight">\(\theta\)</span>:<ul>
<li>if it is too small, some resonant states might be not be
singled-out from the rest of the numerical eigenstates
(<span class="math notranslate nohighlight">\(\theta\)</span> must be larger than the critical angle of the
resonant states one is interested in),</li>
<li>if it is too large, then the bound and resonant states might be
less well reproduced (lower virial values).</li>
</ul>
</li>
<li>For <span class="math notranslate nohighlight">\(x_0\)</span>:<ul>
<li>if it is too large (with respect to the grid extension), then the
coordinate mapping cannot tend to its asymptotical value,
therefore leading to a degradation of the resutls.</li>
<li>On the contrary, if it is too small, then the buffer region is
large, and most of the grid points have no use. These cases
correspond to a bad use of the computational resources.</li>
</ul>
</li>
<li>For <span class="math notranslate nohighlight">\(\lambda\)</span>:<ul>
<li>if it is too small, the coordinate mapping tends to the uniform
complex scaling, and the energies are all aligned.</li>
<li>if it is too large, the transition between the absence and the
presence of the scaling is too sharp (the coordinate mapping
amounts to the bare exterior complex scaling) and the resonant
states cannot be singled out the rest of the numerical
eigenstates, even though the critical angle is large enough.</li>
</ul>
</li>
</ul>
<p>This shows that one has to be careful with the values of the smooth
exterior coordinate mapping parameters, but a generic approach can be
defined: make sure that the buffer zone is large enough for the
asymptotic values of the coordinate mapping to be reached, with a not
too sharp transition aroud <span class="math notranslate nohighlight">\(\pm x_0\)</span> and a large enough angle for
the resonant states to be singled-out.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="influence_grid_continuum.html" class="btn btn-neutral float-right" title="Influence of the grid for continuum states" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="influence_filters_siegerts.html" class="btn btn-neutral" title="Influence of the filters" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Maxime Morinière.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>