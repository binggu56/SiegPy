

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Virial operators &mdash; SiegPy 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Influence of the filters" href="influence_filters_siegerts.html" />
    <link rel="prev" title="Completeness relation with numerical Siegert states" href="completeness_relation_numerical_Siegert.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> SiegPy
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../notebooks.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#d-square-well-potential-the-analytical-case">1D Square-Well Potential: the analytical case</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../notebooks.html#d-square-well-potential-the-numerical-case">1D Square-Well Potential: the numerical case</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="find_numerical_bound_and_continuum.html">Numerical potential: bound and continuum states</a></li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation_numerical_bound_and_continuum.html">Completeness relation using numerical bound and continuum states</a></li>
<li class="toctree-l3"><a class="reference internal" href="find_numerical_Siegert.html">Numerical potential: Siegert states</a></li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation_numerical_Siegert.html">Completeness relation with numerical Siegert states</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Virial operators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Initialization">Initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Choosing-the-virial-operator">Choosing the virial operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Comparing-the-virial-operators">Comparing the virial operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="influence_filters_siegerts.html">Influence of the filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="influence_coordMap_siegerts_1.html">Influence of the coordinate mapping parameters: case study of the ErfKGCoordMap</a></li>
<li class="toctree-l3"><a class="reference internal" href="influence_grid_continuum.html">Influence of the grid for continuum states</a></li>
<li class="toctree-l3"><a class="reference internal" href="influence_grid_siegerts.html">Influence of the grid for Siegert states</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#other-numerical-potentials">Other numerical potentials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_objects.html">Code Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SiegPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../notebooks.html">Tutorial</a> &raquo;</li>
        
      <li>Virial operators</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/influence_virials_siegerts.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Virial-operators">
<h1>Virial operators<a class="headerlink" href="#Virial-operators" title="Permalink to this headline">¶</a></h1>
<p>We saw in previous notebooks that the expectation values of the virial
operators were able to discriminate the Siegert states from any other
type of states. All the previous notebooks only used one type of virial
operator, but there are two definitions in SiegPy. The goal of this
notebook is to present the second type of virial operator, and how it
compares to the default one.</p>
<div class="section" id="Initialization">
<h2>Initialization<a class="headerlink" href="#Initialization" title="Permalink to this headline">¶</a></h2>
<p>The initialization is simple: we only import the useful modules and
classes and then define a potential (which is a 1D Square-Well Potential
discretized over a space grid).</p>
<div class="section" id="Import-some-modules-and-classes">
<h3>Import some modules and classes<a class="headerlink" href="#Import-some-modules-and-classes" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">siegpy</span> <span class="k">import</span> <span class="p">(</span><span class="n">Hamiltonian</span><span class="p">,</span> <span class="n">SWPotential</span><span class="p">,</span> <span class="n">ErfKGCoordMap</span><span class="p">,</span>
                    <span class="n">SWPBasisSet</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Define-a-potential">
<h3>Define a potential<a class="headerlink" href="#Define-a-potential" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># The potential is read from a file...</span>
<span class="n">siegerts</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;siegerts.dat&quot;</span><span class="p">)</span>
<span class="n">pot</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">potential</span>
<span class="c1"># ... and then discretized over a grid</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">pot</span><span class="o">.</span><span class="n">width</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mf">7.5</span>
<span class="n">xgrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">xmax</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="mi">501</span><span class="p">)</span>
<span class="n">pot</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="n">xgrid</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Choosing-the-virial-operator">
<h2>Choosing the virial operator<a class="headerlink" href="#Choosing-the-virial-operator" title="Permalink to this headline">¶</a></h2>
<p>The default virial operator gives one (and only one) value. It actually
measures if the position-momentum commutator is correctly evaluated when
applied to a given eigenstate <span class="math notranslate nohighlight">\(\varphi\)</span>, <em>i.e.</em>, it is such that
<span class="math notranslate nohighlight">\(\left\langle \varphi | [\hat{X}, \hat{P}] | \varphi \right\rangle = i \left\langle \varphi | \varphi \right\rangle\)</span>.
It is referred to as the <strong>Generalized Coplex Virial Theorem</strong> (GCVT).</p>
<p>The other is available for SmoothExtCoordMap instances only, for which a
virial operator
<span class="math notranslate nohighlight">\(\hat{W_\xi} = \frac{\text{d} \hat{H}}{\text{d} \xi}\)</span> per
parameter <span class="math notranslate nohighlight">\(\xi\)</span> (here the angle <span class="math notranslate nohighlight">\(\theta\)</span>, the inflexion
point <span class="math notranslate nohighlight">\(x_0\)</span> and the sharpness <span class="math notranslate nohighlight">\(\lambda\)</span>) is defined
(<span class="math notranslate nohighlight">\(\hat{H}\)</span> is the Hamiltonian considered). These virial operators
measure the stability of each eigenvalue with respect to a given
parameter change. Each virial operator then gives rise to one virial
expectation value per parameter, namely
<span class="math notranslate nohighlight">\(v_\xi = \left\langle \varphi | \hat{W_\xi} | \varphi \right\rangle\)</span>.
These three values are finally mapped into one final virial value
<span class="math notranslate nohighlight">\(v\)</span> by using the following equation
<span class="math notranslate nohighlight">\(v = \sum_{\xi \in [\theta, x_0, \lambda]} | v_\xi |^2\)</span>.</p>
<p>The choice of the type of virial operator used is done while
initializing the coordinate mapping, by setting the optional parameter
<code class="docutils literal notranslate"><span class="pre">GCVT</span></code> either to <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Initial parameters</span>
<span class="n">theta</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">6.0</span>
<span class="n">lbda</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="c1"># Default virial operator: GCVT=True</span>
<span class="n">cm_1</span> <span class="o">=</span> <span class="n">ErfKGCoordMap</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">lbda</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">xgrid</span><span class="p">)</span>
<span class="c1"># Other type of virial operator: GCVT=False</span>
<span class="n">cm_2</span> <span class="o">=</span> <span class="n">ErfKGCoordMap</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">lbda</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">GCVT</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Comparing-the-virial-operators">
<h2>Comparing the virial operators<a class="headerlink" href="#Comparing-the-virial-operators" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Define-and-solve-two-Hamiltonians">
<h3>Define and solve two Hamiltonians<a class="headerlink" href="#Define-and-solve-two-Hamiltonians" title="Permalink to this headline">¶</a></h3>
<p>One Hamitonian per type of virial operator is defined and then solved.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ham_1</span> <span class="o">=</span> <span class="n">Hamiltonian</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">cm_1</span><span class="p">)</span>
<span class="n">ham_2</span> <span class="o">=</span> <span class="n">Hamiltonian</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">cm_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">basis_1</span> <span class="o">=</span> <span class="n">ham_1</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="n">basis_2</span> <span class="o">=</span> <span class="n">ham_2</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Plot-the-energies">
<h3>Plot the energies<a class="headerlink" href="#Plot-the-energies" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">plot_energies</span></code> method of the basis sets allows to see how the
virial values are distributed over the energy spectrum. Note that both
basis sets are made of the same states: only their associated virial
expecation values are different.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">basis_1</span><span class="o">.</span><span class="n">plot_energies</span><span class="p">()</span>
<span class="n">basis_2</span><span class="o">.</span><span class="n">plot_energies</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_virials_siegerts_13_0.png" src="../_images/notebooks_influence_virials_siegerts_13_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_virials_siegerts_13_1.png" src="../_images/notebooks_influence_virials_siegerts_13_1.png" />
</div>
</div>
<p>As you can see, the distribution of the virial expectation values differ
greatly between both virial operators:</p>
<ul class="simple">
<li>The range of virial values is much larger for the second type of
virial operator.</li>
<li>Most importantly, the resonant states with the lowest virial
expectation values are very different: for the default virial
operator, the lowest energy resonant states have the lowest virial
expecation values, while a maximum value is reached far away from the
0 energy for the second type of virial operator:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">basis_2</span><span class="p">[:</span><span class="mi">12</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">virial</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(-9.79608688842+4.10071842408e-14j) 1.14043002476e-10
(-9.18591925228-3.37715726075e-14j) 6.82940051154e-10
(-8.17464337214+4.21396607849e-14j) 3.18687656971e-09
(-6.77260946384+2.61389816265e-14j) 1.80012213375e-08
(1346.81487901-70.0870431848j) 1.33383817064e-07
(1309.64971825-68.7242290591j) 1.43891530556e-07
(1384.60670122-71.4821234553j) 1.53861789445e-07
(-4.99980420562-1.44406627299e-11j) 1.64899673628e-07
(1273.09631514-67.3909816174j) 1.88483607705e-07
(1423.04138812-72.9122466557j) 2.49175889283e-07
(1237.1410264-66.0847007287j) 2.74099981855e-07
(1201.77142174-64.80290349j) 4.14687367264e-07
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">basis_1</span><span class="p">[:</span><span class="mi">12</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">virial</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(-9.79608688842+4.10071842408e-14j) 7.97704509282e-10
(-9.18591925228-3.37715726075e-14j) 3.17680862089e-09
(-8.17464337214+4.21396607849e-14j) 7.08919431335e-09
(-6.77260946384+2.61389816265e-14j) 1.24276304178e-08
(-4.99980420562-1.44406627299e-11j) 1.89478510917e-08
(-2.90018622708-6.14397704638e-09j) 2.59530586763e-08
(-0.626085020601+7.33146819469e-06j) 4.82648903582e-08
(1.87104013925-0.944793379409j) 5.54727310476e-08
(5.52735942521-1.73866474126j) 6.89860589855e-08
(9.68066945927-2.4642996033j) 8.75410584435e-08
(14.3306084456-3.18636534093j) 1.08537828898e-07
(19.4768829199-3.92000638226j) 1.31971445351e-07
</pre></div></div>
</div>
<p>Zooming in more closely to the 0 energy, the differences can be more
easily spotted in this energy range:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">basis_1</span><span class="o">.</span><span class="n">plot_energies</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">7.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="n">basis_2</span><span class="o">.</span><span class="n">plot_energies</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">7.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_virials_siegerts_18_0.png" src="../_images/notebooks_influence_virials_siegerts_18_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_influence_virials_siegerts_18_1.png" src="../_images/notebooks_influence_virials_siegerts_18_1.png" />
</div>
</div>
<p>The variation of the bound state virial values is much larger for the
second type of virial operator, and it makes it more difficult (if not
impossible) to say that the first resonant states can be sorted out from
the rest of the eigenstates by their virial expectation value.</p>
</div>
</div>
<div class="section" id="Conclusion">
<h2>Conclusion<a class="headerlink" href="#Conclusion" title="Permalink to this headline">¶</a></h2>
<p>The default virial operator, measuring how the position-momentum
commutator is correctly evaluated by the eigenstates, is better than the
other one when it comes to separate the Siegert states from the rest of
the numerical eigenstates. It is therefore advised to keep using this
default virial operator.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="influence_filters_siegerts.html" class="btn btn-neutral float-right" title="Influence of the filters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="completeness_relation_numerical_Siegert.html" class="btn btn-neutral" title="Completeness relation with numerical Siegert states" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Maxime Morinière.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>