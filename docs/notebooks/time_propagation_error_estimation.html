

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Time propagation: error estimation of the Siegert states expansions &mdash; SiegPy 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Numerical potential: bound and continuum states" href="find_numerical_bound_and_continuum.html" />
    <link rel="prev" title="Time propagation: wavepacket with an initial momentum" href="time_propagation_initial_momentum.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> SiegPy
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../notebooks.html">Tutorial</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../notebooks.html#d-square-well-potential-the-analytical-case">1D Square-Well Potential: the analytical case</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="find_Siegerts_1DSWP.html">Find the Siegert and continuum states of a 1D Square-Well Potential case</a></li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation.html">Completeness relation: an introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation_problematic_cases.html">Completeness relation: some problematic cases</a></li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation_multiple_test_functions.html">Completeness relation: a wider picture</a></li>
<li class="toctree-l3"><a class="reference internal" href="strength_function.html">Strength function: an introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="convergence_MLE_strength_function.html">Strength function: convergence of the Mittag-Leffler expansion</a></li>
<li class="toctree-l3"><a class="reference internal" href="time_propagation.html">Time propagation: an introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="time_propagation_initial_momentum.html">Time propagation: wavepacket with an initial momentum</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Time propagation: error estimation of the Siegert states expansions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Initialization">Initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Case-1:-initial-wave-packet-with-a-small-initial-momentum">Case 1: initial wave-packet with a small initial momentum</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Case-2:-initial-wave-packet-with-large-initial-momentum">Case 2: initial wave-packet with large initial momentum</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#d-square-well-potential-the-numerical-case">1D Square-Well Potential: the numerical case</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#other-numerical-potentials">Other numerical potentials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_objects.html">Code Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SiegPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../notebooks.html">Tutorial</a> &raquo;</li>
        
      <li>Time propagation: error estimation of the Siegert states expansions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/time_propagation_error_estimation.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Time-propagation:-error-estimation-of-the-Siegert-states-expansions">
<h1>Time propagation: error estimation of the Siegert states expansions<a class="headerlink" href="#Time-propagation:-error-estimation-of-the-Siegert-states-expansions" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">time_propagation_initial_momentum.ipynb</span></code> notebook showed the
overcompleteness of the Siegert states basis set, where we saw that the
Berggren expansion and the one presented in <a class="reference external" href="http://link.aps.org/doi/10.1103/PhysRevA.71.032703">Santra et al., PRA 71
(2005)</a> give
almost similar results.</p>
<p>The goal of this notebook is to assert the quality of different Siegert
states expansion when it comes to evaluate the time-propagation of an
initial wavepacket. The same initial wave-packets as in the previous
notebook will be used: the interest of the present notebook is only to
quantify what was presented in the previous one.</p>
<p>Three different Siegert states expansions will be considered: the
Mittag-Leffler expansion (MLE), the Berggren expansion and the exact
Siegert states expansion (see notebook <code class="docutils literal notranslate"><span class="pre">time_propagation.ipynb</span></code> for
more details on these expansions). They will be compared to the exact
time-propagation using the continuum states.</p>
<div class="section" id="Initialization">
<h2>Initialization<a class="headerlink" href="#Initialization" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Import-useful-modules-and-classes">
<h3>Import useful modules and classes<a class="headerlink" href="#Import-useful-modules-and-classes" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Make the notebook aware of some of the SiegPy module classes</span>
<span class="kn">from</span> <span class="nn">siegpy</span> <span class="k">import</span> <span class="n">SWPBasisSet</span><span class="p">,</span> <span class="n">Gaussian</span><span class="p">,</span> <span class="n">SWPotential</span>
<span class="c1"># Other imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Define-functions-to-estimate-and-show-the-errors">
<h3>Define functions to estimate and show the errors<a class="headerlink" href="#Define-functions-to-estimate-and-show-the-errors" title="Permalink to this headline">¶</a></h3>
<p>The absolute and relative errors of different Siegert states expansions
with respect to the reference result using bound and continuum states
are computed for various times.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">print_errors</span><span class="p">(</span><span class="n">exact</span><span class="p">,</span> <span class="n">siegert_exp</span><span class="p">,</span> <span class="n">dx</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function printing the absolute and relative error of a given</span>
<span class="sd">    Siegert states expansion of the time propagation of a wave-packet</span>
<span class="sd">    for different times.</span>

<span class="sd">    :param exact: Exact time-propagation of a wavepacket.</span>
<span class="sd">    :type exact: 2D numpy.array</span>
<span class="sd">    :param siegert_exp: Siegert states expansion of the time-</span>
<span class="sd">                        propagation of the same wavepacket.</span>
<span class="sd">    :type siegert_exp: 2D numpy.array</span>
<span class="sd">    :param dx: Space grid-step.</span>
<span class="sd">    :type: float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Print lines to initialize the table</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;  t    abs. error   rel. error&quot;</span>
    <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="c1"># Get the error estimations for each time</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">time_grid</span><span class="p">):</span>
        <span class="n">abs_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">exact</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">siegert_exp</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">)</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">exact</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">)</span>
        <span class="c1">#abs_err = np.trapz(np.abs(exact[i] - siegert_exp[i])**2, dx=dx)</span>
        <span class="c1">#norm = np.trapz(np.abs(exact[i])**2, dx=dx)</span>
        <span class="n">rel_err</span> <span class="o">=</span> <span class="n">abs_err</span> <span class="o">/</span> <span class="n">norm</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">   </span><span class="si">{: .3e}</span><span class="s2">   </span><span class="si">{: .3e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">abs_err</span><span class="p">,</span> <span class="n">rel_err</span><span class="p">))</span>
    <span class="c1"># Print lines to finalize the table</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">SSE_errors</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">nres</span><span class="p">,</span> <span class="n">k_max</span><span class="p">,</span> <span class="n">h_k</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">,</span>
               <span class="n">exact</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">MLE</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Ber</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function performing the time-propagation of an initial wave-packet</span>
<span class="sd">    using different Siegert states expansions and printing the absolute</span>
<span class="sd">    and relative errors when compared to the exact time-propagation of</span>
<span class="sd">    this initial wavepacket.</span>

<span class="sd">    :param filename: Name of the file where to look for the Siegert states.</span>
<span class="sd">    :type filename: str</span>
<span class="sd">    :param nres: Number of resonant states to use in the Siegert states expansions.</span>
<span class="sd">    :type nres: int</span>
<span class="sd">    :param k_max: Wavenumber of the last continuum state involved in the exact calculations.</span>
<span class="sd">    :type k_max: float</span>
<span class="sd">    :param h_k: Wavenumber grid step of the continuum basis set.</span>
<span class="sd">    :type h_k: float</span>
<span class="sd">    :param nx: Number of space grid points.</span>
<span class="sd">    :type nx: int</span>
<span class="sd">    :param test_func: Initial wave-packet.</span>
<span class="sd">    :type test_func: Wavefunction</span>
<span class="sd">    :param time_grid: Times at which the</span>
<span class="sd">    :type time_grid: list or numpy.array</span>
<span class="sd">    :param choice: Optional, used to say which Siegert state expansion is desired.</span>
<span class="sd">    :type choice: dict</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Siegert states basis set initialized from a file</span>
    <span class="n">siegerts</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">nres</span><span class="o">=</span><span class="n">nres</span><span class="p">)</span>

    <span class="c1"># Read the potential from a data file</span>
    <span class="n">potential</span> <span class="o">=</span> <span class="n">siegerts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">potential</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">potential</span><span class="o">.</span><span class="n">width</span>

    <span class="c1"># Define a grid space</span>
    <span class="n">xgrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">xgrid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xgrid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Discretize the Siegert states over the grid</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">siegerts</span><span class="p">:</span>
        <span class="n">s</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="n">xgrid</span>

    <span class="c1"># Exact basis set</span>
    <span class="n">cont</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">find_continuum_states</span><span class="p">(</span><span class="n">potential</span><span class="p">,</span> <span class="n">k_max</span><span class="p">,</span> <span class="n">h_k</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">xgrid</span><span class="p">)</span>
    <span class="n">exact</span> <span class="o">=</span> <span class="n">cont</span> <span class="o">+</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">bounds</span>

    <span class="c1"># Evaluation of the exact time propagation</span>
    <span class="n">exact_tp</span> <span class="o">=</span> <span class="n">exact</span><span class="o">.</span><span class="n">exact_propagation</span><span class="p">(</span><span class="n">test_func</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">exact</span><span class="p">:</span>
        <span class="c1"># Evaluation of the exact Siegert expansion of the time propagation</span>
        <span class="n">exact_S_tp</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">exact_Siegert_propagation</span><span class="p">(</span><span class="n">test_func</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">)</span>
        <span class="c1"># Find the error with respect ot the exact time propagation</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;         Exact Siegert&quot;</span><span class="p">)</span>
        <span class="n">print_errors</span><span class="p">(</span><span class="n">exact_tp</span><span class="p">,</span> <span class="n">exact_S_tp</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">MLE</span><span class="p">:</span>
        <span class="c1"># Evaluation of the Mittag-Leffler expansion of the time propagation</span>
        <span class="n">MLE_tp</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">MLE_propagation</span><span class="p">(</span><span class="n">test_func</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">)</span>
        <span class="c1"># Find the error with respect ot the exact time propagation</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;              MLE&quot;</span><span class="p">)</span>
        <span class="n">print_errors</span><span class="p">(</span><span class="n">exact_tp</span><span class="p">,</span> <span class="n">MLE_tp</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">Ber</span><span class="p">:</span>
        <span class="c1"># Evaluation of the Berggren expansion of the time propagation</span>
        <span class="n">Ber_tp</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">Berggren_propagation</span><span class="p">(</span><span class="n">test_func</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">)</span>
        <span class="c1"># Find the error with respect ot the exact time propagation</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;            Berggren&quot;</span><span class="p">)</span>
        <span class="n">print_errors</span><span class="p">(</span><span class="n">exact_tp</span><span class="p">,</span> <span class="n">Ber_tp</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Define-the-filename-of-the-data-file">
<h3>Define the filename of the data file<a class="headerlink" href="#Define-the-filename-of-the-data-file" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Siegert states basis set initialized from a file</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;siegerts.dat&#39;</span>
<span class="n">siegerts</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Case-1:-initial-wave-packet-with-a-small-initial-momentum">
<h2>Case 1: initial wave-packet with a small initial momentum<a class="headerlink" href="#Case-1:-initial-wave-packet-with-a-small-initial-momentum" title="Permalink to this headline">¶</a></h2>
<p>The first initial wave-packet considered uses a small initial momentum.</p>
<div class="section" id="Define-the-test-function">
<h3>Define the test function<a class="headerlink" href="#Define-the-test-function" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">l</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">potential</span><span class="o">.</span><span class="n">width</span>  <span class="c1"># width of the potential</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">l</span><span class="o">/</span><span class="mf">20.</span>  <span class="c1"># width of the Gaussian</span>
<span class="n">x_c</span>   <span class="o">=</span> <span class="o">-</span><span class="n">l</span><span class="o">/</span><span class="mf">4.</span>  <span class="c1"># center of the Gaussian</span>
<span class="n">k_0</span>   <span class="o">=</span> <span class="mf">1.</span>  <span class="c1"># initial momentum</span>
<span class="n">gauss_small_momentum</span> <span class="o">=</span> <span class="n">Gaussian</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">x_c</span><span class="p">,</span> <span class="n">k0</span><span class="o">=</span><span class="n">k_0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Estimation-of-the-errors-of-the-Siegert-states-expansions">
<h3>Estimation of the errors of the Siegert states expansions<a class="headerlink" href="#Estimation-of-the-errors-of-the-Siegert-states-expansions" title="Permalink to this headline">¶</a></h3>
<p>As a starting point, let us use parameters allowing for a moderate
accuracy of the error measurements. The Siegert states and the exact
basis sets have a close extension
(<span class="math notranslate nohighlight">\(|k_{res, max}| \approx k_{max}\)</span>) and the space grid is made of a
limited number of points.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Definition of the time grid</span>
<span class="n">time_grid</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]</span>

<span class="n">SSE_errors</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="n">gauss_small_momentum</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
         Exact Siegert
------------------------------
  t    abs. error   rel. error
------------------------------
0.00    8.722e-06    1.566e-05
0.25    6.219e-07    5.567e-07
0.50    4.425e-07    3.656e-07
0.75    3.630e-07    3.132e-07
1.00    3.156e-07    2.864e-07
2.00    2.260e-07    2.090e-07
3.00    1.863e-07    1.684e-07
------------------------------

              MLE
------------------------------
  t    abs. error   rel. error
------------------------------
0.00    8.722e-06    1.566e-05
0.25    6.329e-01    5.665e-01
0.50    2.953e+03    2.441e+03
0.75    9.029e+08    7.791e+08
1.00    3.302e+14    2.996e+14
2.00    5.546e+36    5.130e+36
3.00    9.162e+58    8.281e+58
------------------------------

            Berggren
------------------------------
  t    abs. error   rel. error
------------------------------
0.00    1.575e-01    2.828e-01
0.25    7.557e-02    6.764e-02
0.50    4.717e-02    3.898e-02
0.75    3.292e-02    2.841e-02
1.00    2.455e-02    2.228e-02
2.00    1.082e-02    1.001e-02
3.00    6.360e-03    5.749e-03
------------------------------

</pre></div></div>
</div>
<p>Let us see the influence of using denser wavenumber and space grids,
that should give more accurate results:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">SSE_errors</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mi">1601</span><span class="p">,</span> <span class="n">gauss_small_momentum</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
         Exact Siegert
------------------------------
  t    abs. error   rel. error
------------------------------
0.00    8.562e-06    1.538e-05
0.25    6.024e-07    5.392e-07
0.50    4.262e-07    3.522e-07
0.75    3.481e-07    3.004e-07
1.00    3.016e-07    2.736e-07
2.00    2.136e-07    1.976e-07
3.00    1.746e-07    1.578e-07
------------------------------

              MLE
------------------------------
  t    abs. error   rel. error
------------------------------
0.00    8.562e-06    1.538e-05
0.25    6.329e-01    5.665e-01
0.50    2.953e+03    2.440e+03
0.75    9.028e+08    7.791e+08
1.00    3.302e+14    2.996e+14
2.00    5.545e+36    5.130e+36
3.00    9.160e+58    8.280e+58
------------------------------

            Berggren
------------------------------
  t    abs. error   rel. error
------------------------------
0.00    1.574e-01    2.828e-01
0.25    7.556e-02    6.764e-02
0.50    4.717e-02    3.897e-02
0.75    3.292e-02    2.840e-02
1.00    2.455e-02    2.228e-02
2.00    1.082e-02    1.001e-02
3.00    6.360e-03    5.749e-03
------------------------------

</pre></div></div>
</div>
<p>As you can see, the previous results were almost converged: the
evaluation of the erros is only slightly modified by the densification
of the grids (especially for the exact Siegert states expansion).</p>
<p>Combining the use of denser wavenumber and space grids grids with an
increase of the range of the continuum states wavenumber grid
(associated to an increase of the number of resonant couples), the
results should be even more accurate:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">SSE_errors</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mi">1601</span><span class="p">,</span> <span class="n">gauss_small_momentum</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
         Exact Siegert
------------------------------
  t    abs. error   rel. error
------------------------------
0.00    8.542e-06    1.534e-05
0.25    6.023e-07    5.391e-07
0.50    4.261e-07    3.521e-07
0.75    3.481e-07    3.004e-07
1.00    3.016e-07    2.736e-07
2.00    2.136e-07    1.976e-07
3.00    1.746e-07    1.578e-07
------------------------------

              MLE
------------------------------
  t    abs. error   rel. error
------------------------------
0.00    8.542e-06    1.534e-05
0.25    6.873e+01    6.153e+01
0.50    1.511e+11    1.248e+11
0.75    5.496e+20    4.743e+20
1.00    1.836e+30    1.665e+30
2.00    1.995e+68    1.845e+68
3.00    2.288e+106    2.069e+106
------------------------------

            Berggren
------------------------------
  t    abs. error   rel. error
------------------------------
0.00    1.574e-01    2.828e-01
0.25    7.556e-02    6.764e-02
0.50    4.717e-02    3.897e-02
0.75    3.292e-02    2.840e-02
1.00    2.455e-02    2.228e-02
2.00    1.082e-02    1.001e-02
3.00    6.360e-03    5.749e-03
------------------------------

</pre></div></div>
</div>
<p>The errors Berggren and the Siegert states expansion are the same as
earlier, showing that the results are converged in terms of the
extension of the basis sets. However, the MLE is even more wrong, and
diverges even more badly; this is not a surprise, since more divergent
terms are added in the sum.</p>
<p>We are now convinced that the error evaluation is sufficiently converged
for our purpose. As expected, the results give the same conclusions as
in the previous notebook:</p>
<ul class="simple">
<li>It is clear that the MLE diverges in the long time limit.</li>
<li>The exact Siegert states expansion produces the best result, whatever
the time.</li>
<li>The errors induced by the use of the Berggren expansion decreases
over time, making it a rather good expansion in the long-time limit,
but not as good as the exact Siegert states expansion.</li>
</ul>
</div>
</div>
<div class="section" id="Case-2:-initial-wave-packet-with-large-initial-momentum">
<h2>Case 2: initial wave-packet with large initial momentum<a class="headerlink" href="#Case-2:-initial-wave-packet-with-large-initial-momentum" title="Permalink to this headline">¶</a></h2>
<p>We saw in the previous notebook that the Berggren expansion was very
good for all times in the case of an initial wave-packet with a large
initial momentum. What are the relative and absolute errors in that
case?</p>
<div class="section" id="Define-the-test-function">
<h3>Define the test function<a class="headerlink" href="#Define-the-test-function" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">k_0</span> <span class="o">=</span> <span class="mf">20.</span>  <span class="c1"># initial momentum</span>
<span class="n">gauss_large_momentum</span> <span class="o">=</span> <span class="n">Gaussian</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">x_c</span><span class="p">,</span> <span class="n">k0</span><span class="o">=</span><span class="n">k_0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Estimation-of-the-errors-of-the-Siegert-states-expansions">
<h3>Estimation of the errors of the Siegert states expansions<a class="headerlink" href="#Estimation-of-the-errors-of-the-Siegert-states-expansions" title="Permalink to this headline">¶</a></h3>
<p>We start with the same parameters leading to moderate accuracy results:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">SSE_errors</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="n">gauss_large_momentum</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
         Exact Siegert
------------------------------
  t    abs. error   rel. error
------------------------------
0.00    1.441e-04    2.588e-04
0.25    5.216e-06    5.375e-05
0.50    4.181e-06    3.773e-04
0.75    3.731e-06    1.190e-03
1.00    3.338e-06    2.036e-03
2.00    2.074e-06    2.424e-03
3.00    1.822e-06    1.985e-03
------------------------------

              MLE
------------------------------
  t    abs. error   rel. error
------------------------------
0.00    1.441e-04    2.588e-04
0.25    2.464e+02    2.539e+03
0.50    5.505e+06    4.969e+08
0.75    7.641e+11    2.438e+14
1.00    3.037e+17    1.852e+20
2.00    4.225e+39    4.939e+42
3.00    7.028e+61    7.657e+64
------------------------------

            Berggren
------------------------------
  t    abs. error   rel. error
------------------------------
0.00    5.335e-04    9.582e-04
0.25    2.731e-04    2.814e-03
0.50    1.774e-04    1.601e-02
0.75    1.270e-04    4.053e-02
1.00    9.689e-05    5.911e-02
2.00    4.642e-05    5.427e-02
3.00    2.899e-05    3.158e-02
------------------------------

</pre></div></div>
</div>
<p>Using denser wavenumber and space grids, we show that the previous
results could already be considered as almost converged with respect to
those parameters:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">SSE_errors</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mi">1601</span><span class="p">,</span> <span class="n">gauss_large_momentum</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
         Exact Siegert
------------------------------
  t    abs. error   rel. error
------------------------------
0.00    1.440e-04    2.586e-04
0.25    5.207e-06    5.365e-05
0.50    4.216e-06    3.806e-04
0.75    3.762e-06    1.201e-03
1.00    3.340e-06    2.037e-03
2.00    2.099e-06    2.454e-03
3.00    1.772e-06    1.931e-03
------------------------------

              MLE
------------------------------
  t    abs. error   rel. error
------------------------------
0.00    1.440e-04    2.586e-04
0.25    2.464e+02    2.539e+03
0.50    5.505e+06    4.969e+08
0.75    7.639e+11    2.438e+14
1.00    3.036e+17    1.852e+20
2.00    4.225e+39    4.939e+42
3.00    7.027e+61    7.656e+64
------------------------------

            Berggren
------------------------------
  t    abs. error   rel. error
------------------------------
0.00    5.332e-04    9.575e-04
0.25    2.731e-04    2.815e-03
0.50    1.774e-04    1.602e-02
0.75    1.270e-04    4.053e-02
1.00    9.690e-05    5.911e-02
2.00    4.643e-05    5.427e-02
3.00    2.899e-05    3.158e-02
------------------------------

</pre></div></div>
</div>
<p>The impact of these parameters (wavenumber and space grid densities) is
smaller than in the case of an initial wavepacket with a smaller initial
momentum. The previous results could already be considered as converged
with respect to those parameters.</p>
<p>Finally, increasing the number of states while using the dense
wavenumber and space grids lead to the following results:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">SSE_errors</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mi">1601</span><span class="p">,</span> <span class="n">gauss_large_momentum</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
         Exact Siegert
------------------------------
  t    abs. error   rel. error
------------------------------
0.00    1.522e-05    2.733e-05
0.25    7.945e-07    8.187e-06
0.50    5.606e-07    5.060e-05
0.75    4.574e-07    1.460e-04
1.00    3.960e-07    2.416e-04
2.00    2.799e-07    3.271e-04
3.00    2.285e-07    2.489e-04
------------------------------

              MLE
------------------------------
  t    abs. error   rel. error
------------------------------
0.00    1.522e-05    2.733e-05
0.25    2.767e+02    2.851e+03
0.50    1.249e+11    1.127e+13
0.75    4.538e+20    1.448e+23
1.00    1.517e+30    9.255e+32
2.00    1.649e+68    1.928e+71
3.00    1.892e+106    2.061e+109
------------------------------

            Berggren
------------------------------
  t    abs. error   rel. error
------------------------------
0.00    4.602e-04    8.264e-04
0.25    2.731e-04    2.815e-03
0.50    1.774e-04    1.602e-02
0.75    1.270e-04    4.052e-02
1.00    9.689e-05    5.910e-02
2.00    4.643e-05    5.428e-02
3.00    2.899e-05    3.158e-02
------------------------------

</pre></div></div>
</div>
<p>These parameters impact the quality of the error, especially for short
time. This is not suprising because the completeness relation for the
intitial wave-packet with a larger initial momentum converges at a
larger wavenumber (see the previous notebook): the convergence with
respect to the highest wavenumber of the basis set is more difficult to
reach.</p>
<p>The results point to the same conclusions as in the first case, mainly
showing that even if the Berggren expansion is in very good agreement
for all times, the exact Siegert states gives better results.</p>
</div>
</div>
<div class="section" id="Conclusion">
<h2>Conclusion<a class="headerlink" href="#Conclusion" title="Permalink to this headline">¶</a></h2>
<p>This concludes our study of the error estimation, showing that the exact
Siegert state expansion truly is the most efficient when it comes to
reproduce the time propagation of wavepacket, whatever the time and the
wavepacket.</p>
<p>For more details on the convergence of the error estimation with respect
to the different parameters, you might consider going through the
<code class="docutils literal notranslate"><span class="pre">time_propagation_error_estimation_convergence.ipynb</span></code> notebook.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="find_numerical_bound_and_continuum.html" class="btn btn-neutral float-right" title="Numerical potential: bound and continuum states" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="time_propagation_initial_momentum.html" class="btn btn-neutral" title="Time propagation: wavepacket with an initial momentum" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Maxime Morinière.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>