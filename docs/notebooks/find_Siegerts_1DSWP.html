

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Find the Siegert and continuum states of a 1D Square-Well Potential case &mdash; SiegPy 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Completeness relation: an introduction" href="completeness_relation.html" />
    <link rel="prev" title="Tutorial" href="../notebooks.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> SiegPy
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../notebooks.html">Tutorial</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../notebooks.html#d-square-well-potential-the-analytical-case">1D Square-Well Potential: the analytical case</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Find the Siegert and continuum states of a 1D Square-Well Potential case</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Import-some-classes-of-the-SiegPy-module">Import some classes of the SiegPy module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Define-a-1D-Square-Well-Potential.">Define a 1D Square-Well Potential.</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Find-the-Siegert-states">Find the Siegert states</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Plot-the-Siegert-states-and-the-basis-sets">Plot the Siegert states and the basis sets</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Variation-of-the-potential-depth">Variation of the potential depth</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Find-the-continuum-states">Find the continuum states</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Continuum-states-around-a-resonance">Continuum states around a resonance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation.html">Completeness relation: an introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation_problematic_cases.html">Completeness relation: some problematic cases</a></li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation_multiple_test_functions.html">Completeness relation: a wider picture</a></li>
<li class="toctree-l3"><a class="reference internal" href="strength_function.html">Strength function: an introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="convergence_MLE_strength_function.html">Strength function: convergence of the Mittag-Leffler expansion</a></li>
<li class="toctree-l3"><a class="reference internal" href="time_propagation.html">Time propagation: an introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="time_propagation_initial_momentum.html">Time propagation: wavepacket with an initial momentum</a></li>
<li class="toctree-l3"><a class="reference internal" href="time_propagation_error_estimation.html">Time propagation: error estimation of the Siegert states expansions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#d-square-well-potential-the-numerical-case">1D Square-Well Potential: the numerical case</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#other-numerical-potentials">Other numerical potentials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_objects.html">Code Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SiegPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../notebooks.html">Tutorial</a> &raquo;</li>
        
      <li>Find the Siegert and continuum states of a 1D Square-Well Potential case</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/find_Siegerts_1DSWP.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Find-the-Siegert-and-continuum-states-of-a-1D-Square-Well-Potential-case">
<h1>Find the Siegert and continuum states of a 1D Square-Well Potential case<a class="headerlink" href="#Find-the-Siegert-and-continuum-states-of-a-1D-Square-Well-Potential-case" title="Permalink to this headline">¶</a></h1>
<p>The goal of this tutorial is to present the basic objects of the SiegPy
module that allows to find the Siegert states of a 1D Square-Well
Potential (SWP).</p>
<div class="section" id="Import-some-classes-of-the-SiegPy-module">
<h2>Import some classes of the SiegPy module<a class="headerlink" href="#Import-some-classes-of-the-SiegPy-module" title="Permalink to this headline">¶</a></h2>
<p>After the installation of the SiegPy module with <code class="docutils literal notranslate"><span class="pre">pip</span></code> (see the online
documentation), you can import it as any other Python package.</p>
<p>To begin with the tutorial, from <code class="docutils literal notranslate"><span class="pre">siegpy</span></code> we import:</p>
<ul class="simple">
<li>the <code class="docutils literal notranslate"><span class="pre">SWPotential</span></code> class, to describe a 1D SWP,</li>
<li>the <code class="docutils literal notranslate"><span class="pre">SWPBasisSet</span></code> class, to represent a basis set made of the
eigenstates of a 1D SWP,</li>
<li>the <code class="docutils literal notranslate"><span class="pre">SWPSiegert</span></code> and the <code class="docutils literal notranslate"><span class="pre">SWPContinuum</span></code> classes, to represent the
two types of eigenstates of the 1D SWP, namely its Siegert states and
its continuum states.</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">siegpy</span> <span class="k">import</span> <span class="n">SWPotential</span><span class="p">,</span> <span class="n">SWPBasisSet</span><span class="p">,</span> <span class="n">SWPSiegert</span><span class="p">,</span> <span class="n">SWPContinuum</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># We also import numpy</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Define-a-1D-Square-Well-Potential.">
<h2>Define a 1D Square-Well Potential.<a class="headerlink" href="#Define-a-1D-Square-Well-Potential." title="Permalink to this headline">¶</a></h2>
<p>A 1D SWP is caracterized by its width <code class="docutils literal notranslate"><span class="pre">l</span></code> and depth <code class="docutils literal notranslate"><span class="pre">V0</span></code>. For
convenience, it is always centered on <span class="math notranslate nohighlight">\(x = 0\)</span>. A space grid may
also be given, for the potential to be plotted.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Potential parameters</span>
<span class="n">V0</span> <span class="o">=</span> <span class="mf">8.</span> <span class="c1"># Depth of the potential</span>
<span class="n">l</span>  <span class="o">=</span> <span class="mf">3.</span> <span class="c1"># Width of the potential</span>

<span class="c1"># Space grid parameters</span>
<span class="n">npts</span> <span class="o">=</span> <span class="mi">401</span> <span class="c1"># Number of points of the grid</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="n">l</span>   <span class="c1"># Extension of the grid</span>
<span class="n">xgrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">l</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>

<span class="c1"># Define a 1D SW potential</span>
<span class="n">potential</span> <span class="o">=</span> <span class="n">SWPotential</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">V0</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">xgrid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>You can plot it, print it and check it is a SWPotential instance:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">potential</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">potential</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">potential</span><span class="p">,</span> <span class="n">SWPotential</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_find_Siegerts_1DSWP_6_0.png" src="../_images/notebooks_find_Siegerts_1DSWP_6_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1D Square-Well Potential of width 3.00 and depth 8.00
True
</pre></div></div>
</div>
</div>
<div class="section" id="Find-the-Siegert-states">
<h2>Find the Siegert states<a class="headerlink" href="#Find-the-Siegert-states" title="Permalink to this headline">¶</a></h2>
<p>The search of the wavenumbers of the Siegert states is limited to a
certain part of the complex wavenumber plane (here, the absolute value
of the real part (resp. imaginary part) of the Siegert wavenumbers must
not exceed <code class="docutils literal notranslate"><span class="pre">re_kmax</span></code> (resp. <code class="docutils literal notranslate"><span class="pre">im_kmax</span></code>).</p>
<p>To find the wavenumbers, one has to define a grid of input-guess, made
of complex wavenumbers. This grid is defined by a grid step on the real
axis <code class="docutils literal notranslate"><span class="pre">re_hk</span></code> and an optional one on the imaginary axis <code class="docutils literal notranslate"><span class="pre">im_hk</span></code>. The
search of the bound and anti bound states on the imaginary axis is
carried out automatically (given that the number of states on this axis
and the range over which they are to be found is defined by the depth
and width of the potential).</p>
<p>In the example below, <code class="docutils literal notranslate"><span class="pre">siegerts</span></code> is a basis set, and its elements are
Siegert states. A Siegert state of the 1D SWP is an instance of the
<code class="docutils literal notranslate"><span class="pre">SWPSiegert</span></code> class.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Look for Siegert states in the complex plane</span>
<span class="n">re_kmax</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">im_kmax</span> <span class="o">=</span> <span class="mf">3.</span>
<span class="n">re_hk</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">im_hk</span> <span class="o">=</span> <span class="mf">2.</span>
<span class="n">siegerts</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">find_Siegert_states</span><span class="p">(</span><span class="n">potential</span><span class="p">,</span> <span class="n">re_kmax</span><span class="p">,</span> <span class="n">re_hk</span><span class="p">,</span> <span class="n">im_kmax</span><span class="p">,</span>
                                           <span class="n">im_hk</span><span class="o">=</span><span class="n">im_hk</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">xgrid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The basis set is a made of Siegert states and is a <code class="docutils literal notranslate"><span class="pre">SWPBasisSet</span></code>
instance:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># siegerts is a SWPBasisSet instance</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">siegerts</span><span class="p">,</span> <span class="n">SWPBasisSet</span><span class="p">)</span>

<span class="c1"># Each state in the basis set is an instance of the SWPSiegert class</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">SWPSiegert</span><span class="p">)</span> <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">siegerts</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>You can easily iterate over the states in the basis set:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of Siegert states in the basis set:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">siegerts</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">siegerts</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;State n°</span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">state</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Note that the states are ordered by type (bound, then anti-bound, then
resonant, and finally anti-resonant states), and that they are stored
from the lowest to the highest energy for each type. You can easily
create a basis set containing only a specific type of Siegert state:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bnds</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">bounds</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bnds</span><span class="p">,</span> <span class="n">SWPBasisSet</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">bnds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">abnds</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">antibounds</span>
<span class="nb">len</span><span class="p">(</span><span class="n">abnds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">res</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">resonants</span>
<span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ares</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">antiresonants</span>
<span class="nb">len</span><span class="p">(</span><span class="n">ares</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This way, you can be sure that the total number of states correspond to
the 20 Siegert states of the original basis set. You could also use the
attributes <code class="docutils literal notranslate"><span class="pre">even</span></code> or <code class="docutils literal notranslate"><span class="pre">odd</span></code> to create a <code class="docutils literal notranslate"><span class="pre">SWPBasisSet</span></code> instance made
of the Siegert states of a given parity.</p>
</div>
<div class="section" id="Plot-the-Siegert-states-and-the-basis-sets">
<h2>Plot the Siegert states and the basis sets<a class="headerlink" href="#Plot-the-Siegert-states-and-the-basis-sets" title="Permalink to this headline">¶</a></h2>
<p><strong>Three types of plot are provided for that purpose:</strong></p>
<ol class="arabic simple">
<li>The first one allows to plot the wavefunctions of any indivual
Siegert states.</li>
</ol>
<ul class="simple">
<li>Another one represent the wavefunctions of all the Siegert states in
the basis set on one plot.</li>
<li>The third type plots of the wavenumbers or the energies of the states
in the basis set.</li>
</ul>
<div class="section" id="Wavefunction-of-a-Siegert-state">
<h3>Wavefunction of a Siegert state<a class="headerlink" href="#Wavefunction-of-a-Siegert-state" title="Permalink to this headline">¶</a></h3>
<p>Given that a grid was passed to the <code class="docutils literal notranslate"><span class="pre">find_Siegert_states</span></code> method, each
Siegert state can be plotted with the <code class="docutils literal notranslate"><span class="pre">plot</span></code> method, just like the
potential. You may also modify the range of the plot by specifying the
optional arguments <code class="docutils literal notranslate"><span class="pre">xlim</span></code> and <code class="docutils literal notranslate"><span class="pre">ylim</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">siegerts</span><span class="p">:</span>
    <span class="c1"># Note the use of the representaton of a Siegert state as title</span>
    <span class="n">state</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">l</span><span class="o">/</span><span class="mf">4.</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">l</span><span class="o">/</span><span class="mf">4.</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="nb">repr</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Note that the resonant and antiresonant states go by pair: the
wavefunction of an antiresonant state correspond to the conjugate of the
resonant wavefunction, and the same relation exists for their energies.
The wavefunction of any Siegert state that is not bound diverges for
infinite <span class="math notranslate nohighlight">\(x\)</span>.</p>
</div>
<div class="section" id="Plot-all-the-wavefunctions-of-the-basis-set">
<h3>Plot all the wavefunctions of the basis set<a class="headerlink" href="#Plot-all-the-wavefunctions-of-the-basis-set" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">SWPBasisSet</span></code> instance has a <code class="docutils literal notranslate"><span class="pre">plot_wavefunctions</span></code> method to plot
the wavefunctions of all the Siegert states in the basis set (except for
the anti-bound states, for clarity). Each wavefunction is translated by
the corresponding energy (or absolute value of the energy for resonant
and anti-resonant states).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">siegerts</span><span class="o">.</span><span class="n">plot_wavefunctions</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>As you can see, the wavefunctions of a pair of resonant and
anti-resonant states have the same real part and an opposite imaginary
part.</p>
<p>The number of resonant states wavefunctions to plot may be defined by
<code class="docutils literal notranslate"><span class="pre">nres</span></code>. You may use <code class="docutils literal notranslate"><span class="pre">file_save</span></code> to define where to save the plot
(the available file formats depend on your <a class="reference external" href="https://matplotlib.org/faq/usage_faq.html#what-is-a-backend">matplotlib
backend</a>).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">siegerts</span><span class="o">.</span><span class="n">plot_wavefunctions</span><span class="p">(</span><span class="n">nres</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">file_save</span><span class="o">=</span><span class="s1">&#39;wavefunctions_2_res.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Note how the resonant couple is related to the bound states: the parity
oscillates between even and odd for the bound states, and this order is
kept for resonant states. Also note the number of antinodes that is
increasing from bottom to top; in particular, the last bound state is
even and has four antinodes inside the potential, while the first
resonant couple is odd and exhibit five antinodes.</p>
<p>Eventually, <code class="docutils literal notranslate"><span class="pre">xlim</span></code> and <code class="docutils literal notranslate"><span class="pre">ylim</span></code> are other optional parameters to set
the plot range. If no resonant states are desired, then only the bound
states are plotted</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">siegerts</span><span class="o">.</span><span class="n">plot_wavefunctions</span><span class="p">(</span><span class="n">nres</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">file_save</span><span class="o">=</span><span class="s1">&#39;wavefunctions_no_res.pdf&#39;</span><span class="p">,</span>
                            <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">V0</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Plot-the-wavenumbers-and-energies-of-the-basis-set">
<h3>Plot the wavenumbers and energies of the basis set<a class="headerlink" href="#Plot-the-wavenumbers-and-energies-of-the-basis-set" title="Permalink to this headline">¶</a></h3>
<p>The wavenumber and energy plots can also be saved in a file by defining
the optional argument <code class="docutils literal notranslate"><span class="pre">file_save</span></code>. Again, the range of the axis of the
plot can be defined by <code class="docutils literal notranslate"><span class="pre">xlim</span></code> and <code class="docutils literal notranslate"><span class="pre">ylim</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">siegerts</span><span class="o">.</span><span class="n">plot_wavenumbers</span><span class="p">(</span><span class="n">file_save</span><span class="o">=</span><span class="s2">&quot;poles_wn.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">siegerts</span><span class="o">.</span><span class="n">plot_energies</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">V0</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">file_save</span><span class="o">=</span><span class="s2">&quot;poles_en.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The four types of Siegert states are clearly visible:</p>
<ul class="simple">
<li>the bound states have positive, purely imaginary wavenumbers (and
therefore negative, purely real energies),</li>
<li>the anti-bound states have negative, purely imaginary wavenumbers
(and therefore negative, purely real energies),</li>
<li>the wavenumber of a resonant state has a positive real part and a
negative imaginary part (and therefore its energy has a positive real
part and a negative imaginary part),</li>
<li>the wavenumber of an anti-resonant state has a negative real part and
a negative imaginary part (and therefore its energy has a positive
real part and a positive imaginary part),</li>
</ul>
</div>
</div>
<div class="section" id="Variation-of-the-potential-depth">
<h2>Variation of the potential depth<a class="headerlink" href="#Variation-of-the-potential-depth" title="Permalink to this headline">¶</a></h2>
<p>It is then easy to compare the Siegert states found for different SW
potentials. The example given here shows that a couple of
resonant/anti-resonant states collapses into two anti-bound states as
the depth of the potential is increased.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Define a some potential depths</span>
<span class="n">depths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">4.65</span><span class="p">,</span> <span class="mf">4.751</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span> <span class="c1"># Multiple potential depths</span>
<span class="n">l</span> <span class="o">=</span> <span class="mf">3.</span>                                <span class="c1"># One potential width</span>

<span class="c1"># Parameters for the search of Siegert states in the complex</span>
<span class="c1"># wavenumber plane</span>
<span class="n">re_kmax</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">im_kmax</span> <span class="o">=</span> <span class="mf">3.</span>
<span class="n">re_hk</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">im_hk</span> <span class="o">=</span> <span class="mf">2.</span>

<span class="c1"># Loop over the depths to create multiple potentials and</span>
<span class="c1"># find their Siegert states</span>
<span class="n">basis_sets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">V0</span> <span class="ow">in</span> <span class="n">depths</span><span class="p">:</span>
    <span class="n">pot</span> <span class="o">=</span> <span class="n">SWPotential</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">V0</span><span class="p">)</span>
    <span class="n">basis_sets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">find_Siegert_states</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">re_kmax</span><span class="p">,</span> <span class="n">re_hk</span><span class="p">,</span>
                                                      <span class="n">im_kmax</span><span class="p">,</span> <span class="n">im_hk</span><span class="o">=</span><span class="n">im_hk</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Plot the wavenumbers for all the potentials</span>
<span class="n">xl</span><span class="o">=</span><span class="mf">3.5</span>
<span class="k">for</span> <span class="n">siegerts</span> <span class="ow">in</span> <span class="n">basis_sets</span><span class="p">:</span>
    <span class="n">siegerts</span><span class="o">.</span><span class="n">plot_wavenumbers</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">xl</span><span class="p">,</span><span class="n">xl</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;$V_0 = </span><span class="si">{:.2f}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">siegerts</span><span class="o">.</span><span class="n">potential</span><span class="o">.</span><span class="n">depth</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>As you can see, a resonant couple has coalesced into two anti-bound
states, one moving down the imaginary axis, the other moving up:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Anti-bound states:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">siegerts</span> <span class="ow">in</span> <span class="n">basis_sets</span><span class="p">:</span>
    <span class="n">abnds</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">antibounds</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;depth:&quot;</span><span class="p">,</span> <span class="n">abnds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">potential</span><span class="o">.</span><span class="n">depth</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ab</span> <span class="ow">in</span> <span class="n">abnds</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;...&quot;</span><span class="p">,</span> <span class="n">ab</span><span class="o">.</span><span class="n">wavenumber</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>If the potential were to be even more decreased, then the anti-bound
state moving up would cross the real axis and become a bound state,
keeping the same number of antinodes inside the potential than the
original resonant state. It is as if the potential was not attractive
enough to fit all the Siegert states as bound states.</p>
</div>
<div class="section" id="Find-the-continuum-states">
<h2>Find the continuum states<a class="headerlink" href="#Find-the-continuum-states" title="Permalink to this headline">¶</a></h2>
<p>The continuum states are known analytically. They are in infinite number
and have a positive energy (hence, continuum). This continuum can be
discretized over a given grid of wavenumbers thanks to the
<code class="docutils literal notranslate"><span class="pre">find_continuum</span></code> method, given a (strictly positive) maximum
wavenumber <code class="docutils literal notranslate"><span class="pre">kmax</span></code> and a grid-step <code class="docutils literal notranslate"><span class="pre">hk</span></code>. An optional minimal
wavenumber <code class="docutils literal notranslate"><span class="pre">kmin</span></code> can be passed as argument.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Let us go back to the initial potential</span>
<span class="n">V0</span> <span class="o">=</span> <span class="mf">8.</span>
<span class="n">l</span>  <span class="o">=</span> <span class="mf">3.</span>
<span class="n">potential</span> <span class="o">=</span> <span class="n">SWPotential</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">V0</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">xgrid</span><span class="p">)</span>

<span class="c1"># Find some continuum states of this potential, whose wavenumbers range</span>
<span class="c1"># fromn 1 to 2 with a wavenumber grid step of 0.25</span>
<span class="n">hk</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">kmax</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">continuum</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">find_continuum_states</span><span class="p">(</span><span class="n">potential</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">hk</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>You can check that the result is a <code class="docutils literal notranslate"><span class="pre">SWPBasisSet</span></code> instance whose states
are <code class="docutils literal notranslate"><span class="pre">SWPContinuum</span></code> instances that have the expected wavenumbers:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># continuum is a SWPBasisSet instance:</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">continuum</span><span class="p">,</span> <span class="n">SWPBasisSet</span><span class="p">)</span>

<span class="c1"># All the states in continuum are SWPContinuum instances:</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">SWPContinuum</span><span class="p">)</span> <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">continuum</span><span class="p">])</span>

<span class="c1"># Their wavenumbers correspond to the expected values:</span>
<span class="n">continuum</span><span class="o">.</span><span class="n">wavenumbers</span>
</pre></div>
</div>
</div>
<p>Note that each wavenumber is repeated twice: this is beacause there are
an even and an odd continuum state for each positive wavenumber.</p>
</div>
<div class="section" id="Continuum-states-around-a-resonance">
<h2>Continuum states around a resonance<a class="headerlink" href="#Continuum-states-around-a-resonance" title="Permalink to this headline">¶</a></h2>
<p>The antinodes of the wavefunctions of continuum states wavefunctions
reach a maximum inside the potential for energies corresponding to the
absolute value of resonant energies. This is only true for the continuum
state of the same parity as the resonance.</p>
<div class="section" id="Around-the-first-resonance">
<h3>Around the first resonance<a class="headerlink" href="#Around-the-first-resonance" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Find some of the Siegert states once again</span>
<span class="n">siegerts</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">find_Siegert_states</span><span class="p">(</span><span class="n">potential</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">re_hk</span><span class="p">,</span> <span class="n">im_kmax</span><span class="p">)</span>

<span class="c1"># Get the first resonant state</span>
<span class="n">ires</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">resonants</span><span class="p">[</span><span class="n">ires</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resonance of absolute energy: </span><span class="si">{:.3f}</span><span class="s2"> (parity: </span><span class="si">{}</span><span class="s2">)&quot;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">energy</span><span class="p">),</span> <span class="n">res</span><span class="o">.</span><span class="n">parity</span><span class="p">))</span>

<span class="c1"># Define a grid of wavenumbers around that resonance</span>
<span class="c1"># and find the continuum states</span>
<span class="n">hk</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">kmid</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">wavenumber</span><span class="p">)</span>
<span class="n">kmin</span> <span class="o">=</span> <span class="n">kmid</span><span class="o">-</span><span class="n">hk</span>
<span class="n">kmax</span> <span class="o">=</span> <span class="n">kmid</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">hk</span><span class="o">/</span><span class="mi">2</span>
<span class="n">continuum</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">find_continuum_states</span><span class="p">(</span><span class="n">potential</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">hk</span><span class="p">,</span>
                                              <span class="n">kmin</span><span class="o">=</span><span class="n">kmin</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">xgrid</span><span class="p">)</span>

<span class="c1"># Plot the even continuum states</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">continuum</span><span class="o">.</span><span class="n">even</span><span class="p">:</span>
    <span class="n">c</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="nb">repr</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>As you can see above, the maximum of amplitude is reached at the
resonant absolute energy for the even continuum states, while it is not
the case for the odd continuum states below:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">continuum</span><span class="o">.</span><span class="n">odd</span><span class="p">:</span>
    <span class="n">c</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="nb">repr</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Around-the-second-resonance">
<h3>Around the second resonance<a class="headerlink" href="#Around-the-second-resonance" title="Permalink to this headline">¶</a></h3>
<p>The second resonance being odd, it is the odd continuum state
wavefunction that reaches a maximum for a wavenumbereauql to the
absolute value of the resonant wavenumber:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Get the first resonant state</span>
<span class="n">ires</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">resonants</span><span class="p">[</span><span class="n">ires</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resonance of absolute energy: </span><span class="si">{:.3f}</span><span class="s2"> (parity: </span><span class="si">{}</span><span class="s2">)&quot;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">energy</span><span class="p">),</span> <span class="n">res</span><span class="o">.</span><span class="n">parity</span><span class="p">))</span>

<span class="c1"># Define a grid of wavenumbers around that resonance</span>
<span class="c1"># and find the continuum states</span>
<span class="n">hk</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">kmid</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">wavenumber</span><span class="p">)</span>
<span class="n">kmin</span> <span class="o">=</span> <span class="n">kmid</span><span class="o">-</span><span class="n">hk</span>
<span class="n">kmax</span> <span class="o">=</span> <span class="n">kmid</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">hk</span><span class="o">/</span><span class="mi">2</span>
<span class="n">continuum</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">find_continuum_states</span><span class="p">(</span><span class="n">potential</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">hk</span><span class="p">,</span>
                                              <span class="n">kmin</span><span class="o">=</span><span class="n">kmin</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">xgrid</span><span class="p">)</span>

<span class="c1"># Plot the odd continuum states</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">continuum</span><span class="o">.</span><span class="n">odd</span><span class="p">:</span>
    <span class="n">c</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="nb">repr</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>This concludes this tutorial showing the basics of the SiegPy module.
You should be able to:</p>
<ul class="simple">
<li>define a square-well potential with the <code class="docutils literal notranslate"><span class="pre">SWPotential</span></code> class,</li>
<li>find Siegert and continuum states that are eigenstates of the
Hamiltonian involving a square-well potential and store them into a
<code class="docutils literal notranslate"><span class="pre">SWPBasisSet</span></code> instance,</li>
<li>use some of their attributes and methods, especially to plot some
quantities of interest.</li>
</ul>
<p>You should also know that:</p>
<ul class="simple">
<li>there are four different types of Siegert states,</li>
<li>the Siegert and continuum states of the SWP are instances of the
<code class="docutils literal notranslate"><span class="pre">SWPSiegert</span></code> and <code class="docutils literal notranslate"><span class="pre">SWPContinuum</span></code> classes, respectively.</li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="completeness_relation.html" class="btn btn-neutral float-right" title="Completeness relation: an introduction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../notebooks.html" class="btn btn-neutral" title="Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Maxime Morinière.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>