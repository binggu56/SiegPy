

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Numerical potential: Siegert states &mdash; SiegPy 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Completeness relation with numerical Siegert states" href="completeness_relation_numerical_Siegert.html" />
    <link rel="prev" title="Completeness relation using numerical bound and continuum states" href="completeness_relation_numerical_bound_and_continuum.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> SiegPy
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../notebooks.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#d-square-well-potential-the-analytical-case">1D Square-Well Potential: the analytical case</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../notebooks.html#d-square-well-potential-the-numerical-case">1D Square-Well Potential: the numerical case</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="find_numerical_bound_and_continuum.html">Numerical potential: bound and continuum states</a></li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation_numerical_bound_and_continuum.html">Completeness relation using numerical bound and continuum states</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Numerical potential: Siegert states</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Initialization">Initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Finding-numerical-eigenstates">Finding numerical eigenstates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Comparison-of-the-numerical-Siegert-states-with-the-analytical-ones">Comparison of the numerical Siegert states with the analytical ones</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation_numerical_Siegert.html">Completeness relation with numerical Siegert states</a></li>
<li class="toctree-l3"><a class="reference internal" href="influence_virials_siegerts.html">Virial operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="influence_filters_siegerts.html">Influence of the filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="influence_coordMap_siegerts_1.html">Influence of the coordinate mapping parameters: case study of the ErfKGCoordMap</a></li>
<li class="toctree-l3"><a class="reference internal" href="influence_grid_continuum.html">Influence of the grid for continuum states</a></li>
<li class="toctree-l3"><a class="reference internal" href="influence_grid_siegerts.html">Influence of the grid for Siegert states</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#other-numerical-potentials">Other numerical potentials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_objects.html">Code Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SiegPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../notebooks.html">Tutorial</a> &raquo;</li>
        
      <li>Numerical potential: Siegert states</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/find_numerical_Siegert.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Numerical-potential:-Siegert-states">
<h1>Numerical potential: Siegert states<a class="headerlink" href="#Numerical-potential:-Siegert-states" title="Permalink to this headline">¶</a></h1>
<p>The present notebook introduces how to find the Siegert states of a
numerical Hamiltonian using <code class="docutils literal notranslate"><span class="pre">SiegPy</span></code>. We still will focus on the 1D
Square-Well Potential (1DSWP) case, for comparisons with analytical
results to be possible. It is very similar to finding the numerical
bound and continuum states, as presented in a previous notebook: the
main difference is the use of another coordinate mapping.</p>
<div class="section" id="Initialization">
<h2>Initialization<a class="headerlink" href="#Initialization" title="Permalink to this headline">¶</a></h2>
<p>Again, the initialization consists in importing some useful classes and
modules and defining a potential.</p>
<div class="section" id="Import-classes-and-modules">
<h3>Import classes and modules<a class="headerlink" href="#Import-classes-and-modules" title="Permalink to this headline">¶</a></h3>
<p>The only modification with respect to the similar notebook where we
presented is the use of a different coordinate mapping, namely
<code class="docutils literal notranslate"><span class="pre">ErfKGCoordMap</span></code> instead of <code class="docutils literal notranslate"><span class="pre">UniformCoordMap</span></code>. For now, it is enough
to say that this type of coordinate mapping is more efficient in finding
Siegert states.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">siegpy</span> <span class="k">import</span> <span class="p">(</span><span class="n">SWPotential</span><span class="p">,</span> <span class="n">SWPBasisSet</span><span class="p">,</span> <span class="n">BasisSet</span><span class="p">,</span>
                    <span class="n">Hamiltonian</span><span class="p">,</span> <span class="n">ErfKGCoordMap</span><span class="p">)</span>
<span class="c1"># We also import numpy and matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Define-a-potential">
<h3>Define a potential<a class="headerlink" href="#Define-a-potential" title="Permalink to this headline">¶</a></h3>
<p>We use the same potential as in the previous notebook.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Read the analytical basis set made of Siegert states</span>
<span class="n">siegerts</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;siegerts.dat&quot;</span><span class="p">)</span>

<span class="c1"># Find its potential, and discretize it over a grid</span>
<span class="n">pot</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">potential</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">pot</span><span class="o">.</span><span class="n">width</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mf">7.5</span>
<span class="n">xgrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">xmax</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="mi">501</span><span class="p">)</span>
<span class="n">pot</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="n">xgrid</span>
<span class="n">pot</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_find_numerical_Siegert_5_0.png" src="../_images/notebooks_find_numerical_Siegert_5_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Finding-numerical-eigenstates">
<h2>Finding numerical eigenstates<a class="headerlink" href="#Finding-numerical-eigenstates" title="Permalink to this headline">¶</a></h2>
<p>Finding numerical Siegert states of a Hamiltonian is done in the same
manner as in the previous notebook, namely:</p>
<ul class="simple">
<li>first, a <code class="docutils literal notranslate"><span class="pre">Hamiltonian</span></code> is defined in matrix form,</li>
<li>and then its eigenvalues and eigenvectors are found in order to
create a <code class="docutils literal notranslate"><span class="pre">BasisSet</span></code> instance.</li>
</ul>
<div class="section" id="Define-the-Hamitonian">
<h3>Define the Hamitonian<a class="headerlink" href="#Define-the-Hamitonian" title="Permalink to this headline">¶</a></h3>
<p>As pointed earlier, the main modification in this notebook is the use of
another type of complex scaling. Instead of simply using a uniform
complex scaling of the space variable (<span class="math notranslate nohighlight">\(x \mapsto x e^{i \theta}\)</span>,
with <span class="math notranslate nohighlight">\(\theta &gt; 0\)</span>), it has been shown that using a (smooth)
exterior complex scaling is a better solution to find high quality
numerical Siegert states. The idea is simple: an inner region is left
unscaled, while the complex scaling is (smoothly) turned on the farthest
regions. This also has the advantage of leaving the inner potential
unscaled.</p>
<p>The coordinate mapping <code class="docutils literal notranslate"><span class="pre">ErfKGCoordMap</span></code> used in this notebook is one of
the many is a coordinate mapping of the type
<span class="math notranslate nohighlight">\(x \mapsto (x \pm x_0) e^{i \theta g(x)} \mp x_0\)</span>, with <span class="math notranslate nohighlight">\(g\)</span>
being a function smoothly going from 0 to 1 around <span class="math notranslate nohighlight">\(\mp x_0\)</span>. In
this case,
<span class="math notranslate nohighlight">\(g: x \mapsto 1 + \frac{1}{2} \left[ \text{erf}(\lambda (x-x_0)) - \text{erf}(\lambda (x+x_0))\right]\)</span>.</p>
<p>Other types of smooth exterior coordinate mappings provided in the
SiegPy module are <code class="docutils literal notranslate"><span class="pre">TanhKGCoordMap</span></code>, <code class="docutils literal notranslate"><span class="pre">ErfSimonCoordMap</span></code> and
<code class="docutils literal notranslate"><span class="pre">TanhSimonCoordMap</span></code> (see SiegPy documentation for more details).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Initialize a coordinate mapping</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">6.0</span>
<span class="n">lbda</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">ErfKGCoordMap</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">lbda</span><span class="p">)</span>

<span class="c1"># Initialize the Hamiltonian with the potential and the coordinate mapping</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">Hamiltonian</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">cm</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Solving-the-Hamiltonian">
<h3>Solving the Hamiltonian<a class="headerlink" href="#Solving-the-Hamiltonian" title="Permalink to this headline">¶</a></h3>
<p>For the moment, nothing new here: you can easily solve the Hamiltonian
to create a basis set:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">basis</span> <span class="o">=</span> <span class="n">ham</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>You can then plot the energies, wavenumbers and wavefunctions as usual:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">basis</span><span class="o">.</span><span class="n">plot_energies</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_find_numerical_Siegert_12_0.png" src="../_images/notebooks_find_numerical_Siegert_12_0.png" />
</div>
</div>
<p>The spectrum is more complex, but, as you can see, there are lots of
states that have a low virial value. They are located near the origin.
By zooming in, we get the following picture:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">basis</span><span class="o">.</span><span class="n">plot_energies</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3500</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_find_numerical_Siegert_14_0.png" src="../_images/notebooks_find_numerical_Siegert_14_0.png" />
</div>
</div>
<p>The states with the lowest virial seem to be bound and resonant states.
This is confirmed by zooming in even more closely:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">basis</span><span class="o">.</span><span class="n">plot_energies</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">4.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_find_numerical_Siegert_16_0.png" src="../_images/notebooks_find_numerical_Siegert_16_0.png" />
</div>
</div>
<p>However, if you would plot the wavefunctions by limiting the number of
resonant states via the <code class="docutils literal notranslate"><span class="pre">nres</span></code> optional argument (as usual), you would
get nothing:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">basis</span><span class="o">.</span><span class="n">plot_wavefunctions</span><span class="p">(</span><span class="n">nres</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_find_numerical_Siegert_18_0.png" src="../_images/notebooks_find_numerical_Siegert_18_0.png" />
</div>
</div>
<p>This is because we did not provide a maximal virial value to sort
between the Siegert states and the rest of the eigenvalues: all states
have an unknwon type:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">len</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">unknown</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[9]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>501
</pre></div>
</div>
</div>
<p>In this case, it is possible to specify the <code class="docutils literal notranslate"><span class="pre">nstates</span></code> optional
argument, that plots the first states of the basis set (<em>i.e.</em> those of
lowest virial):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">basis</span><span class="o">.</span><span class="n">plot_wavefunctions</span><span class="p">(</span><span class="n">nstates</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_find_numerical_Siegert_22_0.png" src="../_images/notebooks_find_numerical_Siegert_22_0.png" />
</div>
</div>
<p>The states with the lowest virial values correspond to bound and
resonant states of lowest energies in this basis set (but it might not
always be the case, especially if the grid is not dense enough or if the
coordinate mapping parameters are not well chosen). Note that the
resonant states wavefunctions tend to zero on the edges of the
simulation box: this is due to the smooth exterior complex scaling, that
compensates for the diverging wavefunctions, making the numerical
resonant states square integrable.</p>
</div>
<div class="section" id="Solving-the-Hamiltonian:-virial-filtering">
<h3>Solving the Hamiltonian: virial filtering<a class="headerlink" href="#Solving-the-Hamiltonian:-virial-filtering" title="Permalink to this headline">¶</a></h3>
<p>We saw that the Siegert states have the lowest virial values in the
basis set. It might therefore be interesting to define a maximal virial
to sort the Siegert states from the rest of the states (of unknown
type). This can be set while solving the Hamiltonian by providing a
postive value to the <code class="docutils literal notranslate"><span class="pre">max_virial</span></code> argument:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">basis_filtered</span> <span class="o">=</span> <span class="n">ham</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">max_virial</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>This allows to separate bound and resonant states from the rest of the
states:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">len</span><span class="p">(</span><span class="n">basis_filtered</span><span class="o">.</span><span class="n">bounds</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">basis_filtered</span><span class="o">.</span><span class="n">resonants</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">basis_filtered</span><span class="o">.</span><span class="n">unknown</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[12]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(7, 30, 464)
</pre></div>
</div>
</div>
<p>The plot of the wavenumbers or energies then only represents the Siegert
states if the <code class="docutils literal notranslate"><span class="pre">show_unknown</span></code> optional argument is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">basis_filtered</span><span class="o">.</span><span class="n">plot_energies</span><span class="p">(</span><span class="n">show_unknown</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_find_numerical_Siegert_29_0.png" src="../_images/notebooks_find_numerical_Siegert_29_0.png" />
</div>
</div>
<p>To plot all the other states, you must set the optional argument
<code class="docutils literal notranslate"><span class="pre">show_unknown</span></code> of <code class="docutils literal notranslate"><span class="pre">plot_energies</span></code> or <code class="docutils literal notranslate"><span class="pre">plot_wavenumbers</span></code> to
<code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>Regarding the <code class="docutils literal notranslate"><span class="pre">plot_wavefunctions</span></code>, using the <code class="docutils literal notranslate"><span class="pre">nres</span></code> optional
argument gives the expected result:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">basis_filtered</span><span class="o">.</span><span class="n">plot_wavefunctions</span><span class="p">(</span><span class="n">nres</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_find_numerical_Siegert_32_0.png" src="../_images/notebooks_find_numerical_Siegert_32_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Comparison-of-the-numerical-Siegert-states-with-the-analytical-ones">
<h2>Comparison of the numerical Siegert states with the analytical ones<a class="headerlink" href="#Comparison-of-the-numerical-Siegert-states-with-the-analytical-ones" title="Permalink to this headline">¶</a></h2>
<p>Only bound and resonant states were found with the current complex
scaling (<em>i.e.</em>, the anti-bound and anti-resonant states are missing),
and we will compare their wavefunctions and energies with those of the
analytical ones.</p>
<div class="section" id="Bound-states">
<h3>Bound states<a class="headerlink" href="#Bound-states" title="Permalink to this headline">¶</a></h3>
<p>Let us first compare the numerical bound states to the analytical ones:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Discretize the analytical siegert states over the same grid as the numerical ones</span>
<span class="n">siegerts</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="n">xgrid</span>
<span class="c1"># Plot the anaytical and numerical bound states</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
    <span class="n">analytical_bnd</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">numerical_bnd</span> <span class="o">=</span> <span class="n">basis_filtered</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Num. energy = </span><span class="si">{0.real}</span><span class="se">\n</span><span class="s2">Exact energy = </span><span class="si">{1.real}</span><span class="s2">&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">numerical_bnd</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span> <span class="n">analytical_bnd</span><span class="o">.</span><span class="n">energy</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">analytical_bnd</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">analytical_bnd</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Re[$WF_</span><span class="si">{analytical}</span><span class="s2">$]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">analytical_bnd</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">analytical_bnd</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Im[$WF_</span><span class="si">{analytical}</span><span class="s2">$]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">numerical_bnd</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">numerical_bnd</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Re[$WF_</span><span class="si">{numerical}</span><span class="s2">$]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">numerical_bnd</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">numerical_bnd</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Im[$WF_</span><span class="si">{numerical}</span><span class="s2">$]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_find_numerical_Siegert_35_0.png" src="../_images/notebooks_find_numerical_Siegert_35_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_find_numerical_Siegert_35_1.png" src="../_images/notebooks_find_numerical_Siegert_35_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_find_numerical_Siegert_35_2.png" src="../_images/notebooks_find_numerical_Siegert_35_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_find_numerical_Siegert_35_3.png" src="../_images/notebooks_find_numerical_Siegert_35_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_find_numerical_Siegert_35_4.png" src="../_images/notebooks_find_numerical_Siegert_35_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_find_numerical_Siegert_35_5.png" src="../_images/notebooks_find_numerical_Siegert_35_5.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_find_numerical_Siegert_35_6.png" src="../_images/notebooks_find_numerical_Siegert_35_6.png" />
</div>
</div>
<p>The energies are almost the same as the ones obtained numerically in the
previous notebook (without a coordinate mapping), the main difference
occuring for the bound state of highest energy: this state exhibits a
longer expontential tail, that is affected by the smooth exterior
coordinate mapping. This is actually the case for all the other state,
but the lower the bound state energy (<em>i.e.</em> the smaller the exponential
tail), the smaller the influence of the coordinate mapping.</p>
</div>
<div class="section" id="Resonant-states">
<h3>Resonant states<a class="headerlink" href="#Resonant-states" title="Permalink to this headline">¶</a></h3>
<p>The resonant states obtained can also be compared to the analytical
resonant states:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Loop over the first three resonant states</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">analytical_res</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">resonants</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">numerical_res</span> <span class="o">=</span> <span class="n">basis_filtered</span><span class="o">.</span><span class="n">resonants</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Num. energy = </span><span class="si">{0:.3f}</span><span class="se">\n</span><span class="s2">Exact energy = </span><span class="si">{1:.3f}</span><span class="s2">&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">numerical_res</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span> <span class="n">analytical_res</span><span class="o">.</span><span class="n">energy</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">analytical_res</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">analytical_res</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Re[$WF_</span><span class="si">{analytical}</span><span class="s2">$]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">analytical_res</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">analytical_res</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Im[$WF_</span><span class="si">{analytical}</span><span class="s2">$]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">numerical_res</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">numerical_res</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Re[$- WF_</span><span class="si">{numerical}</span><span class="s2">$]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">numerical_res</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">numerical_res</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Im[$- WF_</span><span class="si">{numerical}</span><span class="s2">$]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_find_numerical_Siegert_39_0.png" src="../_images/notebooks_find_numerical_Siegert_39_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_find_numerical_Siegert_39_1.png" src="../_images/notebooks_find_numerical_Siegert_39_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_find_numerical_Siegert_39_2.png" src="../_images/notebooks_find_numerical_Siegert_39_2.png" />
</div>
</div>
<p>The wavefunctions of the numerical resonants states are the same as the
analytical ones (save for an unrelevant minus sign): their shape and
normalization are well reproduced in the unscaled region. The main
differences come from the energies, even though they are consistent with
the analytical results, and the exponential divergence of the
wavefunction, that is “absorbed” by the coordinate mapping.</p>
</div>
</div>
<div class="section" id="Conclusion">
<h2>Conclusion<a class="headerlink" href="#Conclusion" title="Permalink to this headline">¶</a></h2>
<p>This notebook presented how to find numerical Siegert states (namely,
bound and resonant states). This was possible thanks to the application
of a smooth exterior complex mapping. The expectation value of the
virial operator has been presented as an important quantity allowing to
separate numerical Siegert states from the rest of the numerical
eigenstates. It was shown that the bound and resonant states found
numerically are comparable to the analytical ones (in terms of energy
and wavefunction, including their normalization).</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="completeness_relation_numerical_Siegert.html" class="btn btn-neutral float-right" title="Completeness relation with numerical Siegert states" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="completeness_relation_numerical_bound_and_continuum.html" class="btn btn-neutral" title="Completeness relation using numerical bound and continuum states" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Maxime Morinière.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>