

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Time propagation: wavepacket with an initial momentum &mdash; SiegPy 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Time propagation: error estimation of the Siegert states expansions" href="time_propagation_error_estimation.html" />
    <link rel="prev" title="Time propagation: an introduction" href="time_propagation.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> SiegPy
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../notebooks.html">Tutorial</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../notebooks.html#d-square-well-potential-the-analytical-case">1D Square-Well Potential: the analytical case</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="find_Siegerts_1DSWP.html">Find the Siegert and continuum states of a 1D Square-Well Potential case</a></li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation.html">Completeness relation: an introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation_problematic_cases.html">Completeness relation: some problematic cases</a></li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation_multiple_test_functions.html">Completeness relation: a wider picture</a></li>
<li class="toctree-l3"><a class="reference internal" href="strength_function.html">Strength function: an introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="convergence_MLE_strength_function.html">Strength function: convergence of the Mittag-Leffler expansion</a></li>
<li class="toctree-l3"><a class="reference internal" href="time_propagation.html">Time propagation: an introduction</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Time propagation: wavepacket with an initial momentum</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Initialization:-import-useful-modules-and-classes">Initialization: import useful modules and classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Case-1:-small-initial-momentum">Case 1: small initial momentum</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Case-2:-larger-initial-momentum">Case 2: larger initial momentum</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="time_propagation_error_estimation.html">Time propagation: error estimation of the Siegert states expansions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#d-square-well-potential-the-numerical-case">1D Square-Well Potential: the numerical case</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#other-numerical-potentials">Other numerical potentials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_objects.html">Code Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SiegPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../notebooks.html">Tutorial</a> &raquo;</li>
        
      <li>Time propagation: wavepacket with an initial momentum</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/time_propagation_initial_momentum.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Time-propagation:-wavepacket-with-an-initial-momentum">
<h1>Time propagation: wavepacket with an initial momentum<a class="headerlink" href="#Time-propagation:-wavepacket-with-an-initial-momentum" title="Permalink to this headline">¶</a></h1>
<p>This notebook is very similar to the the <code class="docutils literal notranslate"><span class="pre">time_propagation.ipynb</span></code>
notebook: the goal is to reproduce the exact time propagation of an
initial wavepacket <span class="math notranslate nohighlight">\(f\)</span>:</p>
<p><span class="math notranslate nohighlight">\(f_{exact}(x, t) = \sum_b \left\langle \varphi_b | f \right\rangle \varphi_b(x) e^{- i E_b t} +  \sum_{p=\pm} \int_0^\infty \text{d} k \left\langle \varphi_p | f \right\rangle \varphi_p(x) e^{- i E(k) t}\)</span></p>
<p>with a Siegert states expansion:</p>
<p><span class="math notranslate nohighlight">\(f_{S}(x, t) = \sum_{S=?}\)</span> <span class="math notranslate nohighlight">\(\alpha_S\)</span>
<span class="math notranslate nohighlight">\(\left( \varphi_S | f(t=0) \right\rangle \varphi_S(x) e^{- i E_S t}\)</span></p>
<p>where <span class="math notranslate nohighlight">\(\alpha_S\)</span> corresponds to a weight.</p>
<p>The main difference with the previous notebook is the use of a
non-centered (<span class="math notranslate nohighlight">\(x_c \neq 0\)</span>) Gaussian wavefunction <span class="math notranslate nohighlight">\(f\)</span> with
an initial momentum <span class="math notranslate nohighlight">\(k_0\)</span>:</p>
<p><span class="math notranslate nohighlight">\(f = h e^{-\frac{(x-x_c)^2}{2 \sigma^2}} e^{i k_0 x}\)</span></p>
<p>We already presented an exact Siegert expansion, where the weight
<span class="math notranslate nohighlight">\(\alpha_S\)</span> depends both on the time and on the state (in contrast
with the Mittag-Leffler or Berggren expansions). We will therefore
mainly use this exact Siegert expansion here.</p>
<div class="section" id="Initialization:-import-useful-modules-and-classes">
<h2>Initialization: import useful modules and classes<a class="headerlink" href="#Initialization:-import-useful-modules-and-classes" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Make the notebook aware of some of the SiegPy module classes</span>
<span class="kn">from</span> <span class="nn">siegpy</span> <span class="k">import</span> <span class="n">SWPBasisSet</span><span class="p">,</span> <span class="n">Gaussian</span>
<span class="c1"># Other imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Case-1:-small-initial-momentum">
<h2>Case 1: small initial momentum<a class="headerlink" href="#Case-1:-small-initial-momentum" title="Permalink to this headline">¶</a></h2>
<p>Nothing is very different from the previous notebook: the main
difference resides in the initial momentum of the test function, and the
fact that the <code class="docutils literal notranslate"><span class="pre">plot_propagation</span></code> method presented in the end of the
previous notebook will be used throughout this one (meaning that there
will be no need to compute the continuum states beforehand).</p>
<div class="section" id="Define-a-1D-Square-Well-Potential-and-create-a-basis-set-made-of-Siegert-states-only">
<h3>Define a 1D Square-Well Potential and create a basis set made of Siegert states only<a class="headerlink" href="#Define-a-1D-Square-Well-Potential-and-create-a-basis-set-made-of-Siegert-states-only" title="Permalink to this headline">¶</a></h3>
<p>To save computation time, the potential and the basis set of Siegert
states are read from the file <code class="docutils literal notranslate"><span class="pre">siegerts.dat</span></code>. A grid is finally
defined and applied to discretize the eigenstates.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Read the potential from a data file:</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;siegerts.dat&#39;</span>
<span class="n">siegerts</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">nres</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>

<span class="c1"># Define a space grid in region II:</span>
<span class="n">potential</span> <span class="o">=</span> <span class="n">siegerts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">potential</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">potential</span><span class="o">.</span><span class="n">width</span>
<span class="n">xgrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>

<span class="c1"># Discretize the Siegert states over the grid:</span>
<span class="n">siegerts</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="n">xgrid</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Define-a-test-function">
<h3>Define a test function<a class="headerlink" href="#Define-a-test-function" title="Permalink to this headline">¶</a></h3>
<p>The test function <span class="math notranslate nohighlight">\(f\)</span> is a Gaussian that must spread in region
<span class="math notranslate nohighlight">\(II\)</span> (inside the potential, where <span class="math notranslate nohighlight">\(|x| \leq l/2\)</span>). It is
non-centered (<span class="math notranslate nohighlight">\(x_c \neq 0\)</span>) and has an initial momentum
(<span class="math notranslate nohighlight">\(k_0 \neq 0\)</span>). This means that test function is complex-valued.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sigma</span> <span class="o">=</span> <span class="n">l</span><span class="o">/</span><span class="mf">20.</span> <span class="c1"># width of the Gaussian</span>
<span class="n">x_c</span>   <span class="o">=</span> <span class="o">-</span><span class="n">l</span><span class="o">/</span><span class="mf">4.</span> <span class="c1"># center of the Gaussian</span>
<span class="n">k_0</span>   <span class="o">=</span> <span class="mf">1.</span>    <span class="c1"># initial momentum</span>
<span class="n">gauss</span> <span class="o">=</span> <span class="n">Gaussian</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">x_c</span><span class="p">,</span> <span class="n">k0</span><span class="o">=</span><span class="n">k_0</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">xgrid</span><span class="p">)</span>
<span class="n">gauss</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_7_0.png" src="../_images/notebooks_time_propagation_initial_momentum_7_0.png" />
</div>
</div>
</div>
<div class="section" id="Make-sure-that-both-basis-sets-are-complete-for-this-test-function">
<h3>Make sure that both basis sets are complete for this test function<a class="headerlink" href="#Make-sure-that-both-basis-sets-are-complete-for-this-test-function" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">siegerts</span><span class="o">.</span><span class="n">plot_completeness_convergence</span><span class="p">(</span><span class="n">gauss</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_9_0.png" src="../_images/notebooks_time_propagation_initial_momentum_9_0.png" />
</div>
</div>
<p>Using the continuum states up to <span class="math notranslate nohighlight">\(k = 20\)</span> is enough for the basis
set to be considered as complete. In comparison, using only 25 resonant
couples (plus the bound and anti-bound states) leads to the same result.</p>
</div>
<div class="section" id="Exact-and-exact-Siegert-expansion-of-the-time-propagation-of-a-Gaussian-wavepacket">
<h3>Exact and exact Siegert expansion of the time propagation of a Gaussian wavepacket<a class="headerlink" href="#Exact-and-exact-Siegert-expansion-of-the-time-propagation-of-a-Gaussian-wavepacket" title="Permalink to this headline">¶</a></h3>
<p>The propagation of the wavepacket is evaluated for the times in
<code class="docutils literal notranslate"><span class="pre">time_grid</span></code>, using the same protocol as in the previous notebook:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Definition of the time grid</span>
<span class="n">time_grid</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]</span>
<span class="c1"># Plot the time propagation of both exact expansions</span>
<span class="n">siegerts</span><span class="o">.</span><span class="n">plot_propagation</span><span class="p">(</span><span class="n">gauss</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_12_0.png" src="../_images/notebooks_time_propagation_initial_momentum_12_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_12_1.png" src="../_images/notebooks_time_propagation_initial_momentum_12_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_12_2.png" src="../_images/notebooks_time_propagation_initial_momentum_12_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_12_3.png" src="../_images/notebooks_time_propagation_initial_momentum_12_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_12_4.png" src="../_images/notebooks_time_propagation_initial_momentum_12_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_12_5.png" src="../_images/notebooks_time_propagation_initial_momentum_12_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_12_6.png" src="../_images/notebooks_time_propagation_initial_momentum_12_6.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_12_7.png" src="../_images/notebooks_time_propagation_initial_momentum_12_7.png" />
</div>
</div>
<p>Again, for any time - and as expected - both exact expansions give the
same time propagation of the initial wavepacket. The non-zero initial
momentum does not influence that fact.</p>
</div>
</div>
<div class="section" id="Case-2:-larger-initial-momentum">
<h2>Case 2: larger initial momentum<a class="headerlink" href="#Case-2:-larger-initial-momentum" title="Permalink to this headline">¶</a></h2>
<p>The case of a large initial momentum exhibits the overcompleteness of
the Siegert states basis set: we will show that using different Siegert
states expansion may lead to very similar and (almost) correct time
propagation under certain conditions.</p>
<p>To that end, the four types of expansions presented in the previous
notebook will be used:</p>
<ul class="simple">
<li>the exact time propagation using the bound and continuum states (used
as the reference),</li>
<li>the Mittag-Leffler expansion (weight <span class="math notranslate nohighlight">\(\alpha_S = 1/2\)</span> for all
Siegert states),</li>
<li>the Berggren expansion (weight <span class="math notranslate nohighlight">\(\alpha_S = 1\)</span> for bound and
resonant states, 0 for the others).</li>
<li>the exact Siegert expansion, using the time and state-dependent
weights <span class="math notranslate nohighlight">\(\alpha_S\)</span> from Eq. 69 of <a class="reference external" href="http://link.aps.org/doi/10.1103/PhysRevA.71.032703">Santra et al., PRA 71
(2005)</a>,</li>
</ul>
<p>We will see that the Berggren expansion, being rather accurate to
reproduce such an initial wavepacket, keeps the same accuracy at any
time, while the Mittag-Leffler is still accurate in the short time limit
only. We will still conclude that the best agreement with the reference
time propagation is obtained by the exact Siegert expansion.</p>
<div class="section" id="New-initial-wavepacket">
<h3>New initial wavepacket<a class="headerlink" href="#New-initial-wavepacket" title="Permalink to this headline">¶</a></h3>
<p>The same Gaussian is used, save its initial momentum, that is larger.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">k_0</span> <span class="o">=</span> <span class="mf">20.</span> <span class="c1"># initial momentum</span>
<span class="n">gauss</span> <span class="o">=</span> <span class="n">Gaussian</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">x_c</span><span class="p">,</span> <span class="n">k0</span><span class="o">=</span><span class="n">k_0</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">xgrid</span><span class="p">)</span>
<span class="n">gauss</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_16_0.png" src="../_images/notebooks_time_propagation_initial_momentum_16_0.png" />
</div>
</div>
</div>
<div class="section" id="Make-sure-that-both-basis-sets-are-complete-for-this-test-function">
<h3>Make sure that both basis sets are complete for this test function<a class="headerlink" href="#Make-sure-that-both-basis-sets-are-complete-for-this-test-function" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">siegerts</span><span class="o">.</span><span class="n">plot_completeness_convergence</span><span class="p">(</span><span class="n">gauss</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_18_0.png" src="../_images/notebooks_time_propagation_initial_momentum_18_0.png" />
</div>
</div>
<p>When compared to the same Gaussian with small or no initial momentum,
the convergence of the completeness relation is very different. <strong>The
basis sets previously defined are no longer complete for this initial
state.</strong></p>
<p>As you can see, the bound and anti-bound states contributions to the
completeness relations are negligible. The same is true for the
continuum or resonant states to the completeness relation below
<span class="math notranslate nohighlight">\(k=10\)</span>. <strong>More continuum and Siegert states have to be included in
both basis sets!</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Extend the Siegert states basis set</span>
<span class="n">siegerts</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">nres</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># Test the exact and MLE of the completeness relation for the new basis sets</span>
<span class="n">siegerts</span><span class="o">.</span><span class="n">plot_completeness_convergence</span><span class="p">(</span><span class="n">gauss</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_20_0.png" src="../_images/notebooks_time_propagation_initial_momentum_20_0.png" />
</div>
</div>
<p>The continuum states (or resonant couples) whose wavenumbers (or
absolute value of the wavenumbers) lie in the 10 to 30 range (<em>e.g.</em>,
centered on the initial momentum) are the most important to reproduce
the initial wavepacket. All other continuum or Siegert states have
negligible influence on the completeness relation.</p>
</div>
<div class="section" id="Time-propagation-of-the-Gaussian-wavepacket">
<h3>Time propagation of the Gaussian wavepacket<a class="headerlink" href="#Time-propagation-of-the-Gaussian-wavepacket" title="Permalink to this headline">¶</a></h3>
<div class="section" id="Exact-vs-MLE">
<h4>Exact vs MLE<a class="headerlink" href="#Exact-vs-MLE" title="Permalink to this headline">¶</a></h4>
<p>As expected, the Mittag-Leffler expansion (MLE) still diverges for long
times, this is why it is not be plotted after certain time, though it is
correct for <span class="math notranslate nohighlight">\(t=0\)</span> and rather good for very short times, while the
wavepacket does not reach the border of region <span class="math notranslate nohighlight">\(II\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">time_grid_MLE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">siegerts</span><span class="o">.</span><span class="n">plot_propagation</span><span class="p">(</span><span class="n">gauss</span><span class="p">,</span> <span class="n">time_grid_MLE</span><span class="p">,</span> <span class="n">exact_Siegert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">MLE</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_24_0.png" src="../_images/notebooks_time_propagation_initial_momentum_24_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_24_1.png" src="../_images/notebooks_time_propagation_initial_momentum_24_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_24_2.png" src="../_images/notebooks_time_propagation_initial_momentum_24_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_24_3.png" src="../_images/notebooks_time_propagation_initial_momentum_24_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_24_4.png" src="../_images/notebooks_time_propagation_initial_momentum_24_4.png" />
</div>
</div>
</div>
<div class="section" id="Exact-vs-Berggren-expansion">
<h4>Exact vs Berggren expansion<a class="headerlink" href="#Exact-vs-Berggren-expansion" title="Permalink to this headline">¶</a></h4>
<p>We use a longer time_grid, because the Berggren expansion does not
diverge as time increases (contrary to the MLE):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">time_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">siegerts</span><span class="o">.</span><span class="n">plot_propagation</span><span class="p">(</span><span class="n">gauss</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">,</span> <span class="n">exact_Siegert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">Berggren</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_26_0.png" src="../_images/notebooks_time_propagation_initial_momentum_26_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_26_1.png" src="../_images/notebooks_time_propagation_initial_momentum_26_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_26_2.png" src="../_images/notebooks_time_propagation_initial_momentum_26_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_26_3.png" src="../_images/notebooks_time_propagation_initial_momentum_26_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_26_4.png" src="../_images/notebooks_time_propagation_initial_momentum_26_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_26_5.png" src="../_images/notebooks_time_propagation_initial_momentum_26_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_26_6.png" src="../_images/notebooks_time_propagation_initial_momentum_26_6.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_26_7.png" src="../_images/notebooks_time_propagation_initial_momentum_26_7.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_26_8.png" src="../_images/notebooks_time_propagation_initial_momentum_26_8.png" />
</div>
</div>
<p>The first important point concerning the Berggren expansion is that it
seems very accurate to express the initial wavepacket for <span class="math notranslate nohighlight">\(t=0\)</span>.
It is as if there were <em>more than one correct Siegert states expansion</em>
for such a test function. This fact actually points to the
<strong>overcompleteness</strong> of the Siegert states basis set, a point that has
been extensively discussed in the literature. The Berggren expansion
still keeps a very good accuracy for all times, but it actually shows
some very small deviations in the long time limit.</p>
<p>Also note that the momentum of the initial wavepacket is large enough
for the propagation to be almost reflection-free at the border of region
<span class="math notranslate nohighlight">\(II\)</span>: the wavepacket is almost entirely transmitted out of region
<span class="math notranslate nohighlight">\(II\)</span>. This is why the amplitude of the y-axis is not constrained
to a defined range after a certain time.</p>
</div>
<div class="section" id="Exact-and-exact-Siegert-states-expansion">
<h4>Exact and exact Siegert states expansion<a class="headerlink" href="#Exact-and-exact-Siegert-states-expansion" title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">siegerts</span><span class="o">.</span><span class="n">plot_propagation</span><span class="p">(</span><span class="n">gauss</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_29_0.png" src="../_images/notebooks_time_propagation_initial_momentum_29_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_29_1.png" src="../_images/notebooks_time_propagation_initial_momentum_29_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_29_2.png" src="../_images/notebooks_time_propagation_initial_momentum_29_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_29_3.png" src="../_images/notebooks_time_propagation_initial_momentum_29_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_29_4.png" src="../_images/notebooks_time_propagation_initial_momentum_29_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_29_5.png" src="../_images/notebooks_time_propagation_initial_momentum_29_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_29_6.png" src="../_images/notebooks_time_propagation_initial_momentum_29_6.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_29_7.png" src="../_images/notebooks_time_propagation_initial_momentum_29_7.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_initial_momentum_29_8.png" src="../_images/notebooks_time_propagation_initial_momentum_29_8.png" />
</div>
</div>
<p>The exact Siegert states expansion uses time and state-dependent weights
for the time-propagation of a wavepacket (where the limit for
<span class="math notranslate nohighlight">\(t=0\)</span> is nothing but the Mittag-Leffler expansion). It gives
excellent agreement with the exact result for all times, even for the
larger times, contrary to the Berggren expansion.</p>
</div>
</div>
</div>
<div class="section" id="Conclusion">
<h2>Conclusion<a class="headerlink" href="#Conclusion" title="Permalink to this headline">¶</a></h2>
<p>The momentum of the initial state does not modify the conclusions
presented in the previous notebooks: the Siegert state expansion
presented in <a class="reference external" href="http://link.aps.org/doi/10.1103/PhysRevA.71.032703">Santra et al., PRA 71
(2005)</a> gives the
best agreement with the reference result, whatever the test function,
whatever the time (long or short time).</p>
<p>We also presented a case where the <em>overcompleteness</em> of the Siegert
states basis set is clearly seen: when the initial momentum is large,
the Berggren expansion gives a very good agreement with the exact
result.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="time_propagation_error_estimation.html" class="btn btn-neutral float-right" title="Time propagation: error estimation of the Siegert states expansions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="time_propagation.html" class="btn btn-neutral" title="Time propagation: an introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Maxime Morinière.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>