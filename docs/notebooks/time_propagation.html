

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Time propagation: an introduction &mdash; SiegPy 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Time propagation: wavepacket with an initial momentum" href="time_propagation_initial_momentum.html" />
    <link rel="prev" title="Strength function: convergence of the Mittag-Leffler expansion" href="convergence_MLE_strength_function.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> SiegPy
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../notebooks.html">Tutorial</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../notebooks.html#d-square-well-potential-the-analytical-case">1D Square-Well Potential: the analytical case</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="find_Siegerts_1DSWP.html">Find the Siegert and continuum states of a 1D Square-Well Potential case</a></li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation.html">Completeness relation: an introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation_problematic_cases.html">Completeness relation: some problematic cases</a></li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation_multiple_test_functions.html">Completeness relation: a wider picture</a></li>
<li class="toctree-l3"><a class="reference internal" href="strength_function.html">Strength function: an introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="convergence_MLE_strength_function.html">Strength function: convergence of the Mittag-Leffler expansion</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Time propagation: an introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Initialization">Initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Exact-and-Mittag-Leffler-expansion-of-the-time-propagation-of-a-Gaussian-wavepacket">Exact and Mittag-Leffler expansion of the time propagation of a Gaussian wavepacket</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Another-type-of-expansion:-the-Berggren-Expansion">Another type of expansion: the Berggren Expansion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Exact-Siegert-expansion">Exact Siegert expansion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="time_propagation_initial_momentum.html">Time propagation: wavepacket with an initial momentum</a></li>
<li class="toctree-l3"><a class="reference internal" href="time_propagation_error_estimation.html">Time propagation: error estimation of the Siegert states expansions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#d-square-well-potential-the-numerical-case">1D Square-Well Potential: the numerical case</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#other-numerical-potentials">Other numerical potentials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_objects.html">Code Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SiegPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../notebooks.html">Tutorial</a> &raquo;</li>
        
      <li>Time propagation: an introduction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/time_propagation.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Time-propagation:-an-introduction">
<h1>Time propagation: an introduction<a class="headerlink" href="#Time-propagation:-an-introduction" title="Permalink to this headline">¶</a></h1>
<p>After the strength function, the time propagation of an initial
wavepacket is another example of how relevant the Siegert states can be
in order to reproduce quantities of physical interest.</p>
<p>The exact time propagation of an initial wavepacket <span class="math notranslate nohighlight">\(f\)</span> using the
bound and continuum states is given by:</p>
<p><span class="math notranslate nohighlight">\(f_{exact}(x, t) = \sum_b \left\langle \varphi_b | f \right\rangle \varphi_b(x) e^{- i E_b t} +  \sum_{p=\pm} \int_0^\infty \text{d} k \left\langle \varphi_p | f \right\rangle \varphi_p(x) e^{- i E(k) t}\)</span></p>
<p>It will be compared to a Siegert states expansion of this
time-propagation:</p>
<p><span class="math notranslate nohighlight">\(f_{S}(x, t) = \sum_{S=?} \alpha_S \left( \varphi_b | f \right\rangle \varphi_b(x) e^{- i E_S t}\)</span></p>
<p>where the important part is the value of the weight <span class="math notranslate nohighlight">\(\alpha_S\)</span>: it
will be shown later that the exact Siegert states expansion has a
precise definition for these weights that does not correspond to the
Mittag-Leffler Expansion (for which each state is counted with a 1/2
weight) except for the initial time <span class="math notranslate nohighlight">\(t=0\)</span>.</p>
<p>The test function <span class="math notranslate nohighlight">\(f\)</span> may be a rectangular or a Gaussian function.
We will focus on the latter type of test function, since the
completeness relation is more easily fulfilled for this type of test
function, and this influences greatly the quality of the
time-propagation (both for exact and Siegert states expansions, since
this reduces the wavenumber (or energy) range of the states used for the
time propagation).</p>
<p>This comparison is performed in the case of the 1D Square-Well Potential
(1DSWP), where the continuum and Siegert states are known analytically.</p>
<div class="section" id="Initialization">
<h2>Initialization<a class="headerlink" href="#Initialization" title="Permalink to this headline">¶</a></h2>
<p>Before actually performing the time propagation of an initial
wavepacket, some initial actions must be performed, to define the
potential and basis sets made of the corresponding eigenstates. The main
difference here is that the eigenstates must be discretized over a space
grid in order for the time propagation of a wavepacket to be performed.</p>
<div class="section" id="Import-some-modules-and-classes">
<h3>Import some modules and classes<a class="headerlink" href="#Import-some-modules-and-classes" title="Permalink to this headline">¶</a></h3>
<p>This does not require any different module imports: no surprise there</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Make the notebook aware of some of the SiegPy module classes</span>
<span class="kn">from</span> <span class="nn">siegpy</span> <span class="k">import</span> <span class="n">Gaussian</span><span class="p">,</span> <span class="n">SWPBasisSet</span>
<span class="c1"># Other imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Define-a-1D-Square-Well-Potential-and-create-a-basis-set-made-of-Siegert-states-only">
<h3>Define a 1D Square-Well Potential and create a basis set made of Siegert states only<a class="headerlink" href="#Define-a-1D-Square-Well-Potential-and-create-a-basis-set-made-of-Siegert-states-only" title="Permalink to this headline">¶</a></h3>
<p>To save computation time, the potential and the basis set of Siegert
states are read from the file <code class="docutils literal notranslate"><span class="pre">siegerts.dat</span></code>. This is still not
different from some previous notebooks.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Read the Siegert states from a data file</span>
<span class="n">siegerts</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;siegerts.dat&#39;</span><span class="p">,</span> <span class="n">nres</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>

<span class="c1"># Define the potential</span>
<span class="n">potential</span> <span class="o">=</span> <span class="n">siegerts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">potential</span>
</pre></div>
</div>
</div>
<p>The difference actually comes from the need to discretize the each
eigenstate over a grid (remember the equations in the introduction: they
require <span class="math notranslate nohighlight">\(\varphi_p(x)\)</span> and <span class="math notranslate nohighlight">\(\varphi_S(x)\)</span>).</p>
<p>Given that:</p>
<ul class="simple">
<li>the Siegert states expansion is supposed to be valid in region
<span class="math notranslate nohighlight">\(II\)</span> (<span class="math notranslate nohighlight">\(|x| \leq l/2\)</span>),</li>
<li>the scalar products between Siegert states and the initial wavepacket
are still computed analytically (each state has the attribute
<code class="docutils literal notranslate"><span class="pre">analytic</span></code> set to <code class="docutils literal notranslate"><span class="pre">True</span></code>),</li>
</ul>
<p>there is no need to use a large, dense grid: it need only be dense
enough for plotting.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Discretize the Siegert states over a space grid in region II:</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">potential</span><span class="o">.</span><span class="n">width</span>
<span class="n">xgrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>
<span class="n">siegerts</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="n">xgrid</span>
</pre></div>
</div>
</div>
<p>In the case you do not have access to a previous data file, the commands
are similar, but in a different order:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># You also need to import the SWPotential class</span>
<span class="kn">import</span> <span class="nn">SWPBasisSet</span><span class="o">,</span> <span class="nn">SWPPotential</span>
<span class="c1"># Define a potential</span>
<span class="n">potential</span> <span class="o">=</span> <span class="n">SWPotential</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="c1"># Create a grid</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">potential</span><span class="o">.</span><span class="n">width</span>
<span class="n">xgrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>
<span class="c1"># Create the basis set with the grid</span>
<span class="n">siegerts</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">find_Siegert_states</span><span class="p">(</span><span class="n">potential</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">xgrid</span><span class="p">)</span>
</pre></div>
</div>
<p>If the data file contains eigenstates that are already discretized, it
is even simpler:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># You don&#39;t need to import the SWPotential class</span>
<span class="kn">import</span> <span class="nn">SWPBasisSet</span>
<span class="c1"># Read the Siegert states from a data file</span>
<span class="n">siegerts</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;siegerts.dat&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Create-an-exact-basis-set">
<h3>Create an exact basis set<a class="headerlink" href="#Create-an-exact-basis-set" title="Permalink to this headline">¶</a></h3>
<p>The exact basis set is made of the bound and continuum states of the
system. The bound states of the <code class="docutils literal notranslate"><span class="pre">siegerts</span></code> basis set may readily be
reused, while a grid of continuum states still has to be computed. This
is done using the <code class="docutils literal notranslate"><span class="pre">find_continuum</span></code> method of the potential (do not
forget to discretize them over a grid by specifying the <code class="docutils literal notranslate"><span class="pre">grid</span></code>
optional parameter):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Find the continuum states of the potential</span>
<span class="n">h_k</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">k_max</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">cont</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">find_continuum_states</span><span class="p">(</span><span class="n">potential</span><span class="p">,</span> <span class="n">k_max</span><span class="p">,</span> <span class="n">h_k</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">xgrid</span><span class="p">)</span>

<span class="c1"># Make the exact basis set</span>
<span class="n">exact</span> <span class="o">=</span> <span class="n">cont</span> <span class="o">+</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">bounds</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Define-a-test-function">
<h3>Define a test function<a class="headerlink" href="#Define-a-test-function" title="Permalink to this headline">¶</a></h3>
<p>The test function <span class="math notranslate nohighlight">\(f\)</span> is a Gaussian that must mostly spread in
region <span class="math notranslate nohighlight">\(II\)</span> (inside the potential, where <span class="math notranslate nohighlight">\(|x| \leq l/2\)</span>). We
start with a centered Gaussian.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sigma</span> <span class="o">=</span> <span class="n">l</span><span class="o">/</span><span class="mf">20.</span> <span class="c1"># width of the Gaussian</span>
<span class="n">x_c</span> <span class="o">=</span> <span class="mf">0.0</span>     <span class="c1"># center of the Gaussian</span>
<span class="n">gauss</span> <span class="o">=</span> <span class="n">Gaussian</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">x_c</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">xgrid</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Exact-and-Mittag-Leffler-expansion-of-the-time-propagation-of-a-Gaussian-wavepacket">
<h2>Exact and Mittag-Leffler expansion of the time propagation of a Gaussian wavepacket<a class="headerlink" href="#Exact-and-Mittag-Leffler-expansion-of-the-time-propagation-of-a-Gaussian-wavepacket" title="Permalink to this headline">¶</a></h2>
<p>To perform the time propagation, the <code class="docutils literal notranslate"><span class="pre">time_grid</span></code> parameter is the last
one to define. It should be a list or a numpy array containing the times
for which the propagated wavepacket is evaluated. Note that all the
times in <code class="docutils literal notranslate"><span class="pre">time_grid</span></code> must be positive (if not, all times are
translated so that they all are positive).</p>
<div class="section" id="Computation">
<h3>Computation<a class="headerlink" href="#Computation" title="Permalink to this headline">¶</a></h3>
<p>The exact time propagation of the Gaussian wavepacket is computed by
applying the <code class="docutils literal notranslate"><span class="pre">exact_propagation</span></code> method to the exact basis set. The
Mittag-Leffler expansion of this time propagation is computed by
applying the <code class="docutils literal notranslate"><span class="pre">MLE_propagation</span></code> method to the Siegert states basis set.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Definition of the time grid</span>
<span class="n">time_grid</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span>

<span class="c1"># Evaluation of the exact time propagation</span>
<span class="n">exact_tp</span> <span class="o">=</span> <span class="n">exact</span><span class="o">.</span><span class="n">exact_propagation</span><span class="p">(</span><span class="n">gauss</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">)</span>

<span class="c1"># Evaluation of the Mittag-Leffler expansion of the time propagation</span>
<span class="n">MLE_tp</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">MLE_propagation</span><span class="p">(</span><span class="n">gauss</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>Note:</strong></p>
<p>Rather than using the exact basis set <code class="docutils literal notranslate"><span class="pre">exact</span></code> defined above, the
<code class="docutils literal notranslate"><span class="pre">exact_propagation</span></code> method may be applied to the basis set
<code class="docutils literal notranslate"><span class="pre">siegerts</span></code>, since the continuum states may be created by this method,
provided that values for the optional parameters <code class="docutils literal notranslate"><span class="pre">hk</span></code> (for the
wavenumber grid step) and <code class="docutils literal notranslate"><span class="pre">kmax</span></code> (for the wavenumber range) are given:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Evaluation of the exact time propagation, creating the continuum states in place</span>
<span class="n">exact_tp</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">exact_propagation</span><span class="p">(</span><span class="n">gauss</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="n">k_max</span><span class="p">,</span> <span class="n">hk</span><span class="o">=</span><span class="n">h_k</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Plotting">
<h3>Plotting<a class="headerlink" href="#Plotting" title="Permalink to this headline">¶</a></h3>
<p>The results of the <code class="docutils literal notranslate"><span class="pre">exact_propagation</span></code> and <code class="docutils literal notranslate"><span class="pre">MLE_propagation</span></code> methods
are arrays of wavepackets <span class="math notranslate nohighlight">\(f(x, t)\)</span>, evaluated at the different
times <span class="math notranslate nohighlight">\(t\)</span> in <code class="docutils literal notranslate"><span class="pre">time_grid</span></code>. We can compare both results for each
time:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">h</span> <span class="o">=</span> <span class="n">gauss</span><span class="o">.</span><span class="n">amplitude</span>
<span class="n">k0</span> <span class="o">=</span> <span class="n">gauss</span><span class="o">.</span><span class="n">momentum</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">time_grid</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;t = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">exact_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Re[$f_</span><span class="si">{exact}</span><span class="s1">(t)$]&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">exact_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Im[$f_</span><span class="si">{exact}</span><span class="s1">(t)$]&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">MLE_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#2166ac&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Re[$f_</span><span class="si">{MLE}</span><span class="s1">(t)$]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">MLE_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#d1e5f0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Im[$f_</span><span class="si">{MLE}</span><span class="s1">(t)$]&#39;</span><span class="p">)</span>
    <span class="c1"># plt.plot(gauss.grid, np.real(gauss.wf), color=&#39;k&#39;)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x, t)$&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_17_0.png" src="../_images/notebooks_time_propagation_17_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_17_1.png" src="../_images/notebooks_time_propagation_17_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_17_2.png" src="../_images/notebooks_time_propagation_17_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_17_3.png" src="../_images/notebooks_time_propagation_17_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_17_4.png" src="../_images/notebooks_time_propagation_17_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_17_5.png" src="../_images/notebooks_time_propagation_17_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_17_6.png" src="../_images/notebooks_time_propagation_17_6.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_17_7.png" src="../_images/notebooks_time_propagation_17_7.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_17_8.png" src="../_images/notebooks_time_propagation_17_8.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_17_9.png" src="../_images/notebooks_time_propagation_17_9.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_17_10.png" src="../_images/notebooks_time_propagation_17_10.png" />
</div>
</div>
<p>While the Mittag-Leffler expansion seems to reproduce exactly the time
propagation for short times, it starts diverging from the exact results
as soon as the propagated wavepacket is reaching the border of region
<span class="math notranslate nohighlight">\(II\)</span>. Both regimes can be understood:</p>
<ul class="simple">
<li>We know that the MLE of the initial Gaussian wavepacket is correct,
since the completeness relation for this test function is fulfilled.
This is why the Gaussian test function is well reproduced for
<span class="math notranslate nohighlight">\(t = 0\)</span>. Furthermore, the MLE is supposed to hold while the
test function is in region <span class="math notranslate nohighlight">\(II\)</span>. This is the reason why the MLE
is valid for short times.</li>
<li>From the second formula of the introduction, it is inferred that the
MLE of the time propagation of a wavepacket <strong>must</strong> diverge for long
positive times because of the anti-resonant states contribution: the
exponential term <span class="math notranslate nohighlight">\(e^{-i E_S t}\)</span> diverges because of the
positive imaginary part of the anti-resonant states energies. Note
that the resonant states contribution would make the MLE of the time
propagation diverge for long negative times.</li>
</ul>
</div>
</div>
<div class="section" id="Another-type-of-expansion:-the-Berggren-Expansion">
<h2>Another type of expansion: the Berggren Expansion<a class="headerlink" href="#Another-type-of-expansion:-the-Berggren-Expansion" title="Permalink to this headline">¶</a></h2>
<p>The Mittag-Leffler, however giving correct results for short times,
cannot be the correct Siegert states expansion: another expansion must
be found. The so-called Berggren expansion (which is discussed in the
literature, <em>e.g.</em>
<a class="reference external" href="http://www.sciencedirect.com/science/article/pii/0375947468905939">1</a>,
<a class="reference external" href="http://link.springer.com/10.1007/BF01289789">2</a>) may be a good
candidate: it requires the use of the bound and resonant states only
(all counted with a weight 1, compared to the 1/2 weight of the MLE).
The anti-resonant states divergence for large positive times disappears
<em>de facto</em>.</p>
<p>This expansion can be applied to the Siegert states basis set via the
<code class="docutils literal notranslate"><span class="pre">Berggren_propagation</span></code> method, using the same time grid and Gaussian
test function:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Evaluation of the Berggren expansion of the time propagation</span>
<span class="n">Ber_tp</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">Berggren_propagation</span><span class="p">(</span><span class="n">gauss</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The result of this expansion is then compared to the exact time
propagation:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">time_grid</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;t = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">exact_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Re[$f_</span><span class="si">{exact}</span><span class="s1">(t)$]&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">exact_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Im[$f_</span><span class="si">{exact}</span><span class="s1">(t)$]&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">Ber_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#d73027&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Re[$f_</span><span class="si">{Ber}</span><span class="s1">(t)$]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">Ber_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#fc8d59&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Im[$f_</span><span class="si">{Ber}</span><span class="s1">(t)$]&#39;</span><span class="p">)</span>
    <span class="c1">#plt.plot(gauss.grid, np.real(gauss.wf), color=&#39;k&#39;)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x, t)$&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_22_0.png" src="../_images/notebooks_time_propagation_22_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_22_1.png" src="../_images/notebooks_time_propagation_22_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_22_2.png" src="../_images/notebooks_time_propagation_22_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_22_3.png" src="../_images/notebooks_time_propagation_22_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_22_4.png" src="../_images/notebooks_time_propagation_22_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_22_5.png" src="../_images/notebooks_time_propagation_22_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_22_6.png" src="../_images/notebooks_time_propagation_22_6.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_22_7.png" src="../_images/notebooks_time_propagation_22_7.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_22_8.png" src="../_images/notebooks_time_propagation_22_8.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_22_9.png" src="../_images/notebooks_time_propagation_22_9.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_22_10.png" src="../_images/notebooks_time_propagation_22_10.png" />
</div>
</div>
<p><strong>In the short time limit, this expansion is not as good as the
Mittag-Leffler expansion.</strong> This is particularly evidenced at
<span class="math notranslate nohighlight">\(t=0\)</span>: the initial Gaussian wavepacket is complex if the Berggren
expansion is used. This proves that the Berggren expansion is not the
natural Siegert states expansion, while the Mittag-Leffler expansion is.
For the latter, the imaginary part of the resonant and anti-resonant
states contribution are the opposite, and their sum is therefore equal
to zero. The Berggren expansion lacks this anti-resonant states
expansion for short times.</p>
<p><strong>However, and as expected, the Berggren expansion does not diverge for
large times. The agreement with the exact time propagation is even very
good for larger times.</strong></p>
<p>This is actually expected: the resonant states contributions to the time
propagation tend to 0 for large times (due to the negative imaginary
part of their energies), and this is also true for the continuum states
(this is known as the RAGE theorem in the mathematical community). The
agreement for very long time is therefore expected, since only the bound
states contributions remain.</p>
<p>Still, the Berggren expansion is very satisfactory for an intermediate
time range, when the continuum states contributions are still relatively
high compared to the bound states contributions. <strong>There might be a
transition between the Mittag-Leffler regime and the Berggren regime.</strong></p>
</div>
<div class="section" id="Exact-Siegert-expansion">
<h2>Exact Siegert expansion<a class="headerlink" href="#Exact-Siegert-expansion" title="Permalink to this headline">¶</a></h2>
<p>We found which expansion should hold in two limits (short and long
time), and a transition from a Mittag-Leffler expansion to a Berggren
expansion is expected. This transition was explained in <a class="reference external" href="http://link.aps.org/doi/10.1103/PhysRevA.71.032703">Santra et al.,
PRA 71 (2005)</a>.
To achieve that, the authors analytically derived the correct weights
for the Siegert states (the <span class="math notranslate nohighlight">\(\alpha_S\)</span> in the second equation in
the introduction of this notebook). Such weights are time-dependent and
also depend on the Siegert state (see eq. 69 of this paper). This exact
Siegert states expansion exactly amount to the Mittag-Leffler for the
initial time <span class="math notranslate nohighlight">\(t=0\)</span> and is somehow related to the Berggren
expansion for <span class="math notranslate nohighlight">\(t \neq 0\)</span>, since only the bound and resonant states
have an exponential decay.</p>
<p>This exact Siegert states propagation is therefore implemented in
SiegPy. It can be called directly by the <code class="docutils literal notranslate"><span class="pre">exact_Siegert_propagation</span></code>
method of a <code class="docutils literal notranslate"><span class="pre">SWPBasisSet</span></code> instance:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">exact_S_tp</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">exact_Siegert_propagation</span><span class="p">(</span><span class="n">gauss</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">time_grid</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;t = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">exact_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Re[$f_</span><span class="si">{exact}</span><span class="s1">(t)$]&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">exact_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Im[$f_</span><span class="si">{exact}</span><span class="s1">(t)$]&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">exact_S_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#276419&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Re[$f_{S, exact}(t)$]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">exact_S_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#b8e186&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Im[$f_{S, exact}(t)$]&#39;</span><span class="p">)</span>
    <span class="c1">#plt.plot(gauss.grid, np.real(gauss.wf), color=&#39;k&#39;)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x, t)$&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_26_0.png" src="../_images/notebooks_time_propagation_26_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_26_1.png" src="../_images/notebooks_time_propagation_26_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_26_2.png" src="../_images/notebooks_time_propagation_26_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_26_3.png" src="../_images/notebooks_time_propagation_26_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_26_4.png" src="../_images/notebooks_time_propagation_26_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_26_5.png" src="../_images/notebooks_time_propagation_26_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_26_6.png" src="../_images/notebooks_time_propagation_26_6.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_26_7.png" src="../_images/notebooks_time_propagation_26_7.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_26_8.png" src="../_images/notebooks_time_propagation_26_8.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_26_9.png" src="../_images/notebooks_time_propagation_26_9.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_time_propagation_26_10.png" src="../_images/notebooks_time_propagation_26_10.png" />
</div>
</div>
<p>As expected, the exact Siegert states expansion gives results that are
in excellent agreement with the exact time propagation using the bound
and continuum states. This agreement is valid for any time considered
(if the exact basis set is dense enough, see the
<code class="docutils literal notranslate"><span class="pre">convergence_exact_time_propagation</span></code> notebook).</p>
<p><strong>Notes:</strong></p>
<p><strong>1-</strong> Even though the <code class="docutils literal notranslate"><span class="pre">MLE_propagation</span></code> or <code class="docutils literal notranslate"><span class="pre">Berggren_expansion</span></code>
methods should be preferred, the <code class="docutils literal notranslate"><span class="pre">Siegert_propagation</span></code> method actually
allows to reproduce their results by specifying a value to the optional
parameter <code class="docutils literal notranslate"><span class="pre">weights</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># MLE expansion</span>
<span class="n">MLE_weights</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;ab&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;ar&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">}</span>
<span class="n">MLE_tp</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">Siegert_propagation</span><span class="p">(</span><span class="n">gauss</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">,</span>
                                      <span class="n">weights</span><span class="o">=</span><span class="n">MLE_weights</span><span class="p">)</span>

<span class="c1"># Berggren expansion</span>
<span class="n">Ber_weights</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">Ber_tp</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">Siegert_propagation</span><span class="p">(</span><span class="n">gauss</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">,</span>
                                      <span class="n">weights</span><span class="o">=</span><span class="n">Ber_weights</span><span class="p">)</span>
</pre></div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">Siegert_propagation</span></code> method in this manner allows to define
another Siegert state expansion, or to isolate the contribution of a
particular type of Siegert states to the time-propagation without
creating another basis set.</p>
<p><strong>2-</strong> In order to get the plots, you can also use the
<code class="docutils literal notranslate"><span class="pre">plot_propagation</span></code> method. Its parameters are the test function and
the time_grid. Its optional arguments <code class="docutils literal notranslate"><span class="pre">exact</span></code> and <code class="docutils literal notranslate"><span class="pre">exact_Siegert</span></code>
are set to <code class="docutils literal notranslate"><span class="pre">True</span></code> by default, meaning that both exact expansions will
be plotted. This means you can plot one or None of those expansions by
setting one or both of these arguments to <code class="docutils literal notranslate"><span class="pre">False</span></code>. Two other optional
arguments, <code class="docutils literal notranslate"><span class="pre">MLE</span></code> and <code class="docutils literal notranslate"><span class="pre">Berggren</span></code>, are set to <code class="docutils literal notranslate"><span class="pre">False</span></code> by default.
The MLE and the Berggren expansions can also be plotted if these
arguments are set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, respectively.</p>
<p>Here are some use cases, allowing to reproduce the three series of plots
presented above in a more concise manner:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Limit the y-axis range of the plots</span>
<span class="n">my_ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="c1"># Plot the exact result and the MLE</span>
<span class="n">siegerts</span><span class="o">.</span><span class="n">plot_propagation</span><span class="p">(</span><span class="n">gauss</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">,</span> <span class="n">exact_Siegert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">MLE</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">my_ylim</span><span class="p">)</span>
<span class="c1"># Plot the exact result and the Berggren expansion</span>
<span class="n">siegerts</span><span class="o">.</span><span class="n">plot_propagation</span><span class="p">(</span><span class="n">gauss</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">,</span> <span class="n">exact_Siegert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">Berggren</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">my_ylim</span><span class="p">)</span>
<span class="c1"># Plot both exact expansions</span>
<span class="n">siegerts</span><span class="o">.</span><span class="n">plot_propagation</span><span class="p">(</span><span class="n">gauss</span><span class="p">,</span> <span class="n">time_grid</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">my_ylim</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that it is not mandatory to have continuum states in the basis set
when plotting the exact expansion, since they can be quickly created
on-the-fly (see the note in the exact and MLE section of this notebook).
The above example would actually compute three times the same continuum
basis set and its contributions to the time-propagation (it is not a
problem because these computations being inexpensive; the gain in
concision is well worth the computation repetition).</p>
</div>
<div class="section" id="Conclusion">
<h2>Conclusion<a class="headerlink" href="#Conclusion" title="Permalink to this headline">¶</a></h2>
<p>You should now be able to perform the most important Siegert states
expansion of the time propagation of a wavepacket, and also to compare
them to the exact result using the bound and continuum states.</p>
<p>You saw that:</p>
<ul class="simple">
<li>there is an exact Siegert states expansion that is not the
Mittag-Leffler expansion,</li>
<li>it however is the same as the Mittag-Leffler expansion for the
initial time <span class="math notranslate nohighlight">\(t=0\)</span>,</li>
<li>it is somehow related to the Berggren expansion for <span class="math notranslate nohighlight">\(t \neq 0\)</span>.</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="time_propagation_initial_momentum.html" class="btn btn-neutral float-right" title="Time propagation: wavepacket with an initial momentum" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="convergence_MLE_strength_function.html" class="btn btn-neutral" title="Strength function: convergence of the Mittag-Leffler expansion" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Maxime Morinière.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>