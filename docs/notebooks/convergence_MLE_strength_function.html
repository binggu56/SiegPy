

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Strength function: convergence of the Mittag-Leffler expansion &mdash; SiegPy 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Time propagation: an introduction" href="time_propagation.html" />
    <link rel="prev" title="Strength function: an introduction" href="strength_function.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> SiegPy
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../notebooks.html">Tutorial</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../notebooks.html#d-square-well-potential-the-analytical-case">1D Square-Well Potential: the analytical case</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="find_Siegerts_1DSWP.html">Find the Siegert and continuum states of a 1D Square-Well Potential case</a></li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation.html">Completeness relation: an introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation_problematic_cases.html">Completeness relation: some problematic cases</a></li>
<li class="toctree-l3"><a class="reference internal" href="completeness_relation_multiple_test_functions.html">Completeness relation: a wider picture</a></li>
<li class="toctree-l3"><a class="reference internal" href="strength_function.html">Strength function: an introduction</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Strength function: convergence of the Mittag-Leffler expansion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Initialization">Initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Tests-of-convergence-of-the-MLE-of-the-strength-function">Tests of convergence of the MLE of the strength function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="time_propagation.html">Time propagation: an introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="time_propagation_initial_momentum.html">Time propagation: wavepacket with an initial momentum</a></li>
<li class="toctree-l3"><a class="reference internal" href="time_propagation_error_estimation.html">Time propagation: error estimation of the Siegert states expansions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#d-square-well-potential-the-numerical-case">1D Square-Well Potential: the numerical case</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#other-numerical-potentials">Other numerical potentials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_objects.html">Code Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SiegPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../notebooks.html">Tutorial</a> &raquo;</li>
        
      <li>Strength function: convergence of the Mittag-Leffler expansion</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/convergence_MLE_strength_function.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Strength-function:-convergence-of-the-Mittag-Leffler-expansion">
<h1>Strength function: convergence of the Mittag-Leffler expansion<a class="headerlink" href="#Strength-function:-convergence-of-the-Mittag-Leffler-expansion" title="Permalink to this headline">¶</a></h1>
<p>We saw in the <code class="docutils literal notranslate"><span class="pre">strength_function.ipynb</span></code> notebook that the strength
function (SF) can be approximated by using a <strong>Mittag-Leffler
expansion</strong> (MLE) of the Green’s function. In this notebook, we’ll see
how the MLE of the SF converges to the exact result when the number of
resonant couples used is increased.</p>
<div class="section" id="Initialization">
<h2>Initialization<a class="headerlink" href="#Initialization" title="Permalink to this headline">¶</a></h2>
<p>This part very similar to the previous notebook, but don’t forget to run
the cells before jumping to the next section!</p>
<div class="section" id="Import-some-modules-and-classes">
<h3>Import some modules and classes<a class="headerlink" href="#Import-some-modules-and-classes" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Make the notebook aware of some of the SiegPy module classes</span>
<span class="kn">from</span> <span class="nn">siegpy</span> <span class="k">import</span> <span class="n">SWPBasisSet</span><span class="p">,</span> <span class="n">Rectangular</span><span class="p">,</span> <span class="n">Gaussian</span><span class="p">,</span> <span class="n">SWPotential</span>
<span class="c1"># Other imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Create-a-basis-set-made-of-Siegert-states-only">
<h3>Create a basis-set made of Siegert states only<a class="headerlink" href="#Create-a-basis-set-made-of-Siegert-states-only" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">siegerts</span> <span class="o">=</span> <span class="n">SWPBasisSet</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;siegerts.dat&quot;</span><span class="p">,</span> <span class="n">nres</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Define-test-functions-to-evaluate-the-strength-function">
<h3>Define test functions to evaluate the strength function<a class="headerlink" href="#Define-test-functions-to-evaluate-the-strength-function" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">l</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">potential</span><span class="o">.</span><span class="n">width</span>  <span class="c1"># width of the potential</span>
<span class="n">x_c</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Center of the test functions</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">l</span><span class="o">/</span><span class="mi">2</span>  <span class="c1"># Width of the rectangular function</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">l</span><span class="o">/</span><span class="mi">20</span>  <span class="c1"># Width of the Gaussian</span>
<span class="n">test_gauss</span> <span class="o">=</span> <span class="n">Gaussian</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">x_c</span><span class="p">)</span>  <span class="c1"># Gaussian test function</span>
<span class="n">test_rect</span> <span class="o">=</span> <span class="n">Rectangular</span><span class="o">.</span><span class="n">from_width_and_center</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">x_c</span><span class="p">)</span>  <span class="c1"># Rectangular test function</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Create-the-grid-of-wavenumbers-where-the-strength-function-is-evaluated">
<h3>Create the grid of wavenumbers where the strength function is evaluated<a class="headerlink" href="#Create-the-grid-of-wavenumbers-where-the-strength-function-is-evaluated" title="Permalink to this headline">¶</a></h3>
<p>It is not mandatory to keep the same grid as for the continuum states,
and it is strongly advised to decrease this number as much as possible
to save computation time, since an integration over all continuum states
is performed for each point in this grid, that only defines the grid
used for plotting.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">h_k</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># Grid-step for plotting</span>
<span class="n">k_max</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Maximal wavenumber for plotting</span>
<span class="n">kgrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">h_k</span><span class="p">,</span> <span class="n">k_max</span><span class="p">,</span> <span class="n">h_k</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Tests-of-convergence-of-the-MLE-of-the-strength-function">
<h2>Tests of convergence of the MLE of the strength function<a class="headerlink" href="#Tests-of-convergence-of-the-MLE-of-the-strength-function" title="Permalink to this headline">¶</a></h2>
<p>We present the evolution of the MLE of the strength function as a
function of the number of resonant couples included in the approximated
Green’s function.</p>
<p>We will see that with only a few resonant couples considered, it is
possible to get a correct evaluation of the strength function on a
rather large range of wavenumber</p>
<div class="section" id="Case-1:-Gaussian-test-function">
<h3>Case 1: Gaussian test function<a class="headerlink" href="#Case-1:-Gaussian-test-function" title="Permalink to this headline">¶</a></h3>
<p>The first step corresponds in evaluating the strength function for basis
sets of increasing size. To that end, the contribution of all the bound
and anti-bound states is evaluated separately (stored in <code class="docutils literal notranslate"><span class="pre">b_a_MLE_g</span></code>),
while the strength function associated to each resonant couple is stored
in the list <code class="docutils literal notranslate"><span class="pre">r_MLE_g</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create basis sets with bound and antibound states, with resonant states</span>
<span class="c1"># and with anti-resonant states.</span>
<span class="n">bnds_abnds</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">bounds</span> <span class="o">+</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">antibounds</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">resonants</span>
<span class="n">ares</span> <span class="o">=</span> <span class="n">siegerts</span><span class="o">.</span><span class="n">antiresonants</span>

<span class="c1"># Contribution of the bound and anti-bound states to the MLE of the SF</span>
<span class="n">b_a_MLE_g</span> <span class="o">=</span> <span class="n">bnds_abnds</span><span class="o">.</span><span class="n">MLE_strength_function</span><span class="p">(</span><span class="n">test_gauss</span><span class="p">,</span> <span class="n">kgrid</span><span class="p">)</span>
<span class="c1"># Contribution of each resonant couple to the MLE of the SF</span>
<span class="n">r_MLE_g</span>   <span class="o">=</span> <span class="p">[</span><span class="n">SWPBasisSet</span><span class="p">(</span><span class="n">states</span><span class="o">=</span><span class="p">[</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ares</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="o">.</span><span class="n">MLE_strength_function</span><span class="p">(</span><span class="n">test_gauss</span><span class="p">,</span> <span class="n">kgrid</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">))]</span>
</pre></div>
</div>
</div>
<p>After some matplotlib manipulation, you get the following plot:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Plot the reference, with all siegert states</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kgrid</span><span class="p">,</span> <span class="n">b_a_MLE_g</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">r_MLE_g</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$N_</span><span class="si">{res}</span><span class="s1">$ = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)))</span>
<span class="c1">#Plot the first: bound states contribution only</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#0c2c84&#39;</span><span class="p">,</span> <span class="s1">&#39;#1d91c0&#39;</span><span class="p">,</span> <span class="s1">&#39;#7fcdbb&#39;</span><span class="p">,</span> <span class="s1">&#39;#c7e9b4&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kgrid</span><span class="p">,</span> <span class="n">b_a_MLE_g</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$N_</span><span class="si">{res}</span><span class="s1">$ = 0&#39;</span><span class="p">)</span>
<span class="c1">#Plot the rest</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kgrid</span><span class="p">,</span> <span class="n">b_a_MLE_g</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">r_MLE_g</span><span class="p">[:</span><span class="n">i</span><span class="p">]),</span>
             <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$N_</span><span class="si">{res}</span><span class="s1">$ = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$k$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$R(k)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gaussian test function&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_convergence_MLE_strength_function_13_0.png" src="../_images/notebooks_convergence_MLE_strength_function_13_0.png" />
</div>
</div>
<p>As you can see, using a handful of resonant couples leads to almost
converged result over a rather large range of wavenumbers. Remember that
the exact result would require a rather dense basis set of continuum
states to reach the same convergence, while the physical information on
the resonances would be absent. The approximation of the Green’s
function by Siegert states is very promising.</p>
</div>
<div class="section" id="Case-2:-rectangular-test-function">
<h3>Case 2: rectangular test function<a class="headerlink" href="#Case-2:-rectangular-test-function" title="Permalink to this headline">¶</a></h3>
<p>You can easily repeat that same study for a rectangular test function:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Contribution of the bound and anti-bound states to the MLE of the SF</span>
<span class="n">b_a_MLE_r</span> <span class="o">=</span> <span class="n">bnds_abnds</span><span class="o">.</span><span class="n">MLE_strength_function</span><span class="p">(</span><span class="n">test_rect</span><span class="p">,</span> <span class="n">kgrid</span><span class="p">)</span>
<span class="c1"># Contribution of each resonant couples to the MLE of the SF</span>
<span class="n">r_MLE_r</span>   <span class="o">=</span> <span class="p">[</span><span class="n">SWPBasisSet</span><span class="p">([</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ares</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="o">.</span><span class="n">MLE_strength_function</span><span class="p">(</span><span class="n">test_rect</span><span class="p">,</span> <span class="n">kgrid</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">))]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Plot the reference, with all siegert states</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kgrid</span><span class="p">,</span> <span class="n">b_a_MLE_r</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">r_MLE_r</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$N_</span><span class="si">{res}</span><span class="s1">$ = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)))</span>
<span class="c1">#Plot the first: bound states contribution only</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#0c2c84&#39;</span><span class="p">,</span> <span class="s1">&#39;#1d91c0&#39;</span><span class="p">,</span> <span class="s1">&#39;#41b6c4&#39;</span><span class="p">,</span> <span class="s1">&#39;#7fcdbb&#39;</span><span class="p">,</span> <span class="s1">&#39;#c7e9b4&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kgrid</span><span class="p">,</span> <span class="n">b_a_MLE_r</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$N_</span><span class="si">{res}</span><span class="s1">$ = 0&#39;</span><span class="p">)</span>
<span class="c1">#Plot the rest</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kgrid</span><span class="p">,</span> <span class="n">b_a_MLE_r</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">r_MLE_r</span><span class="p">[:</span><span class="n">i</span><span class="p">]),</span>
             <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$N_</span><span class="si">{res}</span><span class="s1">$ = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$k$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$R(k)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Rectangular test function&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_convergence_MLE_strength_function_17_0.png" src="../_images/notebooks_convergence_MLE_strength_function_17_0.png" />
</div>
</div>
<p>Note that, even if the strength function erroneously reaches negative
values, the position and the shape of the first peaks are still very
well reproduced by only a few resonant couples.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="time_propagation.html" class="btn btn-neutral float-right" title="Time propagation: an introduction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="strength_function.html" class="btn btn-neutral" title="Strength function: an introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Maxime Morinière.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>